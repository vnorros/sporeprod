(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    182170,       4643]
NotebookOptionsPosition[    178531,       4588]
NotebookOutlinePosition[    179036,       4606]
CellTagsIndexPosition[    178993,       4603]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<`*\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<MultivariateStatistics`\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.5402075225625*^9, 3.54020759721875*^9}, {
   3.540207633390625*^9, 3.540207729421875*^9}, {3.5402832448125*^9, 
   3.540283245328125*^9}, 3.5413288838585*^9, {3.54149998046875*^9, 
   3.54149999921875*^9}, {3.54606465253125*^9, 3.54606465690625*^9}, 
   3.6513933870111933`*^9, {3.8782633527423534`*^9, 
   3.8782633607658405`*^9}},ExpressionUUID->"7fd13139-b081-43fd-8fb5-\
ddb5e63a3a37"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**"}], "*****)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"**", "Importing"}], " ", "&"}], " ", "processing", " ", "the", 
    " ", "data"}], " ", "***)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**"}], "*****)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Change", " ", "to", " ", "the", " ", "directory", " ", "containing", " ", 
    "the", " ", "data", " ", "files"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"mydirectory", "=", "\"\<D:\\\\Spore production\>\""}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"columnlabels", "[", "table_", "]"}], ":=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"table", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"table", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "[", "mydirectory", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sta", "=", 
     RowBox[{
      RowBox[{"Import", "[", "\"\<samples.xls\>\"", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "data", " ", "on", " ", "each", " ", "spore", " ", "production", " ", 
       "sample"}], ",", " ", 
      RowBox[{"including", " ", "species"}], ",", " ", 
      RowBox[{"start", " ", "and", " ", "end", " ", "time"}], ",", " ", 
      "trunk", ",", " ", 
      RowBox[{
       RowBox[{"spores", "/", "cm2"}], "/", "h"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"sta", "=", 
     RowBox[{"Select", "[", 
      RowBox[{"sta", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "\[NotEqual]", "0"}], "&"}]}], 
      "]"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"undetermined", " ", "species", " ", "removed"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"species", "=", 
     RowBox[{"Union", "[", 
      RowBox[{
       RowBox[{"Rest", "[", "sta", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "5"}], "]"}], "]"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "species", " ", "for", " ", "which", " ", "there", " ", "is", " ", 
      "spore", " ", "production", " ", "data"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"trunks", "=", 
     RowBox[{"Union", "[", 
      RowBox[{
       RowBox[{"Rest", "[", "sta", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "9"}], "]"}], "]"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "trunks", " ", "for", " ", "which", " ", "there", " ", "is", " ", 
      "spore", " ", "production", " ", "data"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"sampledays", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DateList", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"IntegerPart", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"10", ";;", "12"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "&"}], 
       ",", 
       RowBox[{"Rest", "[", "sta", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"days", "=", 
     RowBox[{"Union", "[", "sampledays", "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "days", " ", "for", " ", "which", " ", "there", " ", "is", " ", "spore", 
     " ", "production", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dta", "=", 
     RowBox[{
      RowBox[{"Import", "[", "\"\<days.xls\>\"", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"data", " ", "on", " ", "sampling", " ", "days"}], ",", " ", 
      RowBox[{
      "including", " ", "weather", " ", "variables", " ", "and", " ", 
       "sunrise", " ", "and", " ", "sunset", " ", "times"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"dtadates", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DateList", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"IntegerPart", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "3"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "&"}],
          ",", 
         RowBox[{"Rest", "[", "dta", "]"}]}], "]"}], ",", 
       "\"\<DateList\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dta", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "dta", "]"}], ",", "dtadates"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dta", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"dta", ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"days", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "20", "]"}], "]"}]}], "]"}], "&"}]}], "]"}], ",", 
       RowBox[{"dta", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lta", "=", 
     RowBox[{
      RowBox[{"Import", "[", "\"\<trunks.xls\>\"", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"data", " ", "on", " ", "trunks", " ", 
       RowBox[{"(", 
        RowBox[{"aka", " ", "logs"}], ")"}]}], ",", " ", 
      RowBox[{"including", " ", "tree", " ", "species"}], ",", " ", 
      RowBox[{"diameter", " ", "and", " ", "decay", " ", "class"}]}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"lta", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"lta", ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"trunks", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "]"}], ",", 
       RowBox[{"lta", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tta", "=", 
     RowBox[{
      RowBox[{"Import", "[", "\"\<species.xls\>\"", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"species", " ", "and", " ", "their", " ", "traits", " ", 
     RowBox[{"(", 
      RowBox[{"spore", " ", "size", " ", "and", " ", 
       RowBox[{"resupinate", "/", "pileate"}]}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tta", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"tta", ",", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"species", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}]}], "]"}], ",", 
       RowBox[{"tta", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Printing", " ", "the", " ", "headers", " ", "of", " ", "each", " ", 
     "table"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"columnlabels", "[", "sta", "]"}], "\[IndentingNewLine]", 
   RowBox[{"columnlabels", "[", "dta", "]"}], "\[IndentingNewLine]", 
   RowBox[{"columnlabels", "[", "lta", "]"}], "\[IndentingNewLine]", 
   RowBox[{"columnlabels", "[", "tta", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.671548472994678*^9, 3.6715484886332893`*^9}, {
   3.671548528215634*^9, 3.671548701761701*^9}, {3.6715487445941916`*^9, 
   3.67154877007825*^9}, {3.6715488002733536`*^9, 3.67154882344569*^9}, 
   3.671548869482031*^9, {3.67154890341864*^9, 3.6715489399604135`*^9}, {
   3.6715494854236736`*^9, 3.671549486224516*^9}, {3.6715500795538607`*^9, 
   3.671550079938637*^9}, {3.67155019608238*^9, 3.671550196866537*^9}, {
   3.6715519448334*^9, 3.6715520092584543`*^9}, {3.6715520425868034`*^9, 
   3.671552077651535*^9}, {3.6715528751216464`*^9, 3.6715528754905233`*^9}, {
   3.67155318552742*^9, 3.6715531976750584`*^9}, {3.6715533309538584`*^9, 
   3.6715533908812084`*^9}, {3.671553431060353*^9, 3.671553431923606*^9}, {
   3.6715574452042446`*^9, 3.671557454817277*^9}, {3.671798229703004*^9, 
   3.671798233052559*^9}, 3.839483673191104*^9, {3.878263362544423*^9, 
   3.878263459589907*^9}, {3.878263507488161*^9, 3.878263547974763*^9}, {
   3.878263600941579*^9, 3.8782637960075517`*^9}, {3.878263837640007*^9, 
   3.8782638391023397`*^9}, {3.878263926717209*^9, 3.8782639814975963`*^9}, {
   3.8782640274081945`*^9, 3.8782640481454487`*^9}, {3.878264086986743*^9, 
   3.8782640904269967`*^9}, {3.8782641379197683`*^9, 
   3.8782641472415504`*^9}, {3.8782641905550137`*^9, 3.878264197210429*^9}, {
   3.878264229193416*^9, 
   3.878264232211583*^9}},ExpressionUUID->"2192cc4b-6793-41bd-8aa2-\
0faa87cec6a2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "\<\"ID\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\<\"year\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "\<\"sample\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "\<\"spores/cm2/tot sampling time\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "\<\"Species\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "\<\"Incl?\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "\<\"start\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "\<\"finish\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "\<\"trunk\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "\<\"year\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "\<\"month\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "\<\"day\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "\<\"start h\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "\<\"start min\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "\<\"finish h\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"16", ",", "\<\"finish min\"\>"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6715492300404105`*^9, 3.671549235917985*^9}, 
   3.671553403880014*^9, 3.6715534449020443`*^9, 3.671795493841319*^9, 
   3.6718135531216574`*^9, 3.671881822435275*^9, 3.671882815611154*^9, 
   3.671885846858858*^9, 3.671969139058196*^9, 3.672054577287735*^9, 
   3.839483683949644*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"82587be5-6cfb-4fa3-bcff-63e488bd5b86"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "\<\"Year\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\<\"Month\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "\<\"Day\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "\<\"Hour start\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "\<\"Min start\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "\<\"Sec start\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "\<\"Hour stop\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "\<\"Min stop\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "\<\"Sec stop\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "\<\"Day nbr\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "\<\"T sum 30 d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "\<\"Rain sum 30 d\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "\<\"Rain sum 24 h\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "\<\"Mean T\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "\<\"Mean RH\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "16", ",", "\<\"Sunrise h in Jkl (wintertime; timeanddate.com)\"\>"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "17", ",", "\<\"Sunrise min  in Jkl (wintertime; timeanddate.com)\"\>"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "18", ",", "\<\"Sunset h  in Jkl (wintertime; timeanddate.com)\"\>"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "19", ",", "\<\"Sunset min  in Jkl (wintertime; timeanddate.com)\"\>"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"20", ",", "\<\"DateList\"\>"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6715492300404105`*^9, 3.671549235917985*^9}, 
   3.671553403880014*^9, 3.6715534449020443`*^9, 3.671795493841319*^9, 
   3.6718135531216574`*^9, 3.671881822435275*^9, 3.671882815611154*^9, 
   3.671885846858858*^9, 3.671969139058196*^9, 3.672054577287735*^9, 
   3.839483683952637*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"35a7ca25-4a93-482a-aff5-3ae1c9cc0991"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "\<\"Trunk nbr\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\<\"Tree sp\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "\<\"Log basal diameter (cm)(2009)\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "\<\"Mean decay class (2009)\"\>"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6715492300404105`*^9, 3.671549235917985*^9}, 
   3.671553403880014*^9, 3.6715534449020443`*^9, 3.671795493841319*^9, 
   3.6718135531216574`*^9, 3.671881822435275*^9, 3.671882815611154*^9, 
   3.671885846858858*^9, 3.671969139058196*^9, 3.672054577287735*^9, 
   3.8394836839556293`*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"cabc7d76-af71-4eaf-8178-a500664d243d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "\<\"Species\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\<\"Log vol\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "\<\"Growth form (0=res, 1=pil)\"\>"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6715492300404105`*^9, 3.671549235917985*^9}, 
   3.671553403880014*^9, 3.6715534449020443`*^9, 3.671795493841319*^9, 
   3.6718135531216574`*^9, 3.671881822435275*^9, 3.671882815611154*^9, 
   3.671885846858858*^9, 3.671969139058196*^9, 3.672054577287735*^9, 
   3.8394836839576235`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"e7541cc1-a095-4097-a31f-c71f1836b0fe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"standardizing", " ", "to", " ", "mean", " ", "0"}], ",", " ", 
    RowBox[{"stdev", " ", "1"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"standardise", "[", "datatable_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"head", ",", "names", ",", "body", ",", "stdbodytrans"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"head", "=", 
         RowBox[{"datatable", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"names", "=", 
         RowBox[{"Rest", "[", 
          RowBox[{"datatable", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"body", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Rest", "[", 
           RowBox[{"Transpose", "[", 
            RowBox[{"Rest", "[", "datatable", "]"}], "]"}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"stdbodytrans", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"body", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "i"}], "]"}], "]"}], "-", 
              RowBox[{"Mean", "[", 
               RowBox[{"body", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "i"}], "]"}], "]"}], "]"}]}], ")"}], "/", 
            RowBox[{"StandardDeviation", "[", 
             RowBox[{"body", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "i"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"body", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Prepend", "[", 
            RowBox[{"stdbodytrans", ",", "names"}], "]"}], "]"}], ",", 
          "head"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stdtraits", "=", 
     RowBox[{"standardise", "[", "tta", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stdtrunks", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"standardise", "[", 
          RowBox[{"lta", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "3", ",", "4"}], "}"}]}], "]"}], "]"}], "]"}],
          "]"}], ",", 
        RowBox[{"lta", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"meanRH", "[", "daynbr_", "]"}], ":=", 
     RowBox[{"32.9", "+", 
      RowBox[{"0.207", "*", "daynbr"}]}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Equation", " ", "from", " ", "regression", " ", "of", " ", "RH", " ", 
       "against", " ", "calendar", " ", "day"}], ";", " ", 
      RowBox[{
      "regression", " ", "analysis", " ", "not", " ", "included", " ", 
       "here"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"resRH", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Rest", "[", 
         RowBox[{"dta", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "15"}], "]"}], "]"}], "]"}], "-", 
        RowBox[{"Map", "[", 
         RowBox[{"meanRH", ",", 
          RowBox[{"Rest", "[", 
           RowBox[{"dta", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "10"}], "]"}], "]"}], "]"}]}], "]"}]}], ",", 
       "\"\<Residual RH (vs. day nbr)\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rain24pres", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", ">", "0"}], ",", "0.", ",", "1."}], "]"}], "&"}], 
         ",", 
         RowBox[{"Rest", "[", 
          RowBox[{"dta", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "13"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
       "\"\<Rain in last 24h?\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"year", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", "\[Equal]", "2009."}], ",", "0.", ",", "1."}], "]"}],
           "&"}], ",", 
         RowBox[{"Rest", "[", 
          RowBox[{"dta", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
       "\"\<Year (0=2009,1=2010)\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stddays", "=", 
     RowBox[{"standardise", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dta", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "20"}], "]"}], "]"}], ",", "year", ",", 
         RowBox[{"dta", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "10"}], "]"}], "]"}], ",", "rain24pres", ",", 
         "resRH"}], "}"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"startdatelists", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"DateList", "[", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"IntegerPart", "[", 
           RowBox[{"sta", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", 
              RowBox[{"10", ";;", "14"}]}], "]"}], "]"}], "]"}], ",", "0"}], 
         "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "[", "sta", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"finishdatelists", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"DateList", "[", 
        RowBox[{
         RowBox[{"AbsoluteTime", "[", 
          RowBox[{"DateList", "[", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"IntegerPart", "[", 
              RowBox[{"sta", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{"10", ",", "11", ",", "12", ",", "15", ",", "16"}], 
                  "}"}]}], "]"}], "]"}], "]"}], ",", "0"}], "]"}], "]"}], 
          "]"}], "+", 
         RowBox[{"3600", "*", "24"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "[", "sta", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"shours", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"AbsoluteTime", ",", "finishdatelists"}], "]"}], "-", 
        RowBox[{"Map", "[", 
         RowBox[{"AbsoluteTime", ",", "startdatelists"}], "]"}]}], ")"}], "/",
       "3600."}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"samplesunrises", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"DateList", "[", 
        RowBox[{
         RowBox[{"AbsoluteTime", "[", 
          RowBox[{
           RowBox[{"sampledays", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "+", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{"dta", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "20", "]"}], "]"}], "\[Equal]", 
                   RowBox[{"sampledays", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", 
                 RowBox[{"16", ";;", "17"}]}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", "0", "}"}]}], "]"}]}], "]"}], "+", "3600"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "sampledays", "]"}]}], "}"}]}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "Also", " ", "changed", " ", "to", " ", "daylight", " ", "saving", " ", 
      "hours"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"samplesunsets", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"DateList", "[", 
        RowBox[{
         RowBox[{"AbsoluteTime", "[", 
          RowBox[{
           RowBox[{"sampledays", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "+", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{
               RowBox[{"Select", "[", 
                RowBox[{"dta", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "20", "]"}], "]"}], "\[Equal]", 
                   RowBox[{"sampledays", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "&"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", 
                 RowBox[{"18", ";;", "19"}]}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", "0", "}"}]}], "]"}]}], "]"}], "+", "3600"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "sampledays", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "Also", " ", "changed", " ", "to", " ", "daylight", " ", "saving", " ", 
     "hours"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nighttimes", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"AbsoluteTime", "[", 
            RowBox[{"samplesunrises", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", 
           RowBox[{"3600", "*", "24"}], "-", 
           RowBox[{"AbsoluteTime", "[", 
            RowBox[{"samplesunsets", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ")"}], "/", "3600"}], 
        "/", 
        RowBox[{"shours", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "shours", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stdnighttimes", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"nighttimes", "-", 
        RowBox[{"Mean", "[", "nighttimes", "]"}]}], ")"}], "/", 
      RowBox[{"StandardDeviation", "[", "nighttimes", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"logsporesperh", "=", 
     RowBox[{"Log", "[", 
      RowBox[{
       RowBox[{"Rest", "[", 
        RowBox[{"sta", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}], "/", "shours"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"lognighttimes", "=", 
     RowBox[{"Log", "[", "nighttimes", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Histogram", "[", "logsporesperh", "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Plotting", " ", "a", " ", "histogram", " ", "of", " ", "sample"}], "-", 
     RowBox[{"specific", " ", "spore", " ", "production", " ", "rates"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stdsamples", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sta", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"sta", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"sta", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"sta", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "5"}], "]"}], "]"}], ",", 
        RowBox[{"sta", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "9"}], "]"}], "]"}], ",", 
        RowBox[{"Prepend", "[", 
         RowBox[{"sampledays", ",", "\"\<Datelist\>\""}], "]"}], ",", 
        RowBox[{"Prepend", "[", 
         RowBox[{"logsporesperh", ",", "\"\<Log spores/cm2/h\>\""}], "]"}], 
        ",", 
        RowBox[{"Prepend", "[", 
         RowBox[{"stdnighttimes", ",", "\"\<std prop night\>\""}], "]"}]}], 
       "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"columnlabels", "[", "stdsamples", "]"}], "\[IndentingNewLine]", 
   RowBox[{"columnlabels", "[", "stdtrunks", "]"}], "\[IndentingNewLine]", 
   RowBox[{"columnlabels", "[", "stddays", "]"}], "\[IndentingNewLine]", 
   RowBox[{"columnlabels", "[", "stdtraits", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6715502670851803`*^9, 3.6715503230043774`*^9}, {
  3.67155048101724*^9, 3.6715504813173485`*^9}, {3.6715505160449915`*^9, 
  3.671550827427682*^9}, {3.6715508639679756`*^9, 3.6715511530696754`*^9}, {
  3.671551240568303*^9, 3.6715512434165783`*^9}, {3.6715512779298077`*^9, 
  3.671551288092518*^9}, {3.6718134479186554`*^9, 3.671813450653366*^9}, {
  3.8782642478087497`*^9, 3.878264352159299*^9}, {3.87826440530998*^9, 
  3.878264466640829*^9}, {3.8782648082797813`*^9, 
  3.8782648238820148`*^9}},ExpressionUUID->"2ec43869-0971-4ec3-8908-\
6f980004b230"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
    Opacity[0.48999999999999994`], Thickness[Small]}], {}, 
    {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
     Opacity[0.48999999999999994`], Thickness[Small]}], 
     RectangleBox[{0.5, 0}, {1., 2.},
      RoundingRadius->0], RectangleBox[{1., 0}, {1.5, 2.},
      RoundingRadius->0], RectangleBox[{2., 0}, {2.5, 1.},
      RoundingRadius->0], RectangleBox[{2.5, 0}, {3., 4.},
      RoundingRadius->0], RectangleBox[{3., 0}, {3.5, 22.},
      RoundingRadius->0], RectangleBox[{3.5, 0}, {4., 177.},
      RoundingRadius->0], RectangleBox[{4., 0}, {4.5, 124.},
      RoundingRadius->0], RectangleBox[{4.5, 0}, {5., 203.},
      RoundingRadius->0], RectangleBox[{5., 0}, {5.5, 191.},
      RoundingRadius->0], RectangleBox[{5.5, 0}, {6., 272.},
      RoundingRadius->0], RectangleBox[{6., 0}, {6.5, 161.},
      RoundingRadius->0], RectangleBox[{6.5, 0}, {7., 124.},
      RoundingRadius->0], RectangleBox[{7., 0}, {7.5, 135.},
      RoundingRadius->0], RectangleBox[{7.5, 0}, {8., 151.},
      RoundingRadius->0], RectangleBox[{8., 0}, {8.5, 117.},
      RoundingRadius->0], RectangleBox[{8.5, 0}, {9., 143.},
      RoundingRadius->0], RectangleBox[{9., 0}, {9.5, 140.},
      RoundingRadius->0], RectangleBox[{9.5, 0}, {10., 129.},
      RoundingRadius->0], RectangleBox[{10., 0}, {10.5, 136.},
      RoundingRadius->0], RectangleBox[{10.5, 0}, {11., 117.},
      RoundingRadius->0], RectangleBox[{11., 0}, {11.5, 86.},
      RoundingRadius->0], RectangleBox[{11.5, 0}, {12., 94.},
      RoundingRadius->0], RectangleBox[{12., 0}, {12.5, 68.},
      RoundingRadius->0], RectangleBox[{12.5, 0}, {13., 55.},
      RoundingRadius->0], RectangleBox[{13., 0}, {13.5, 56.},
      RoundingRadius->0], RectangleBox[{13.5, 0}, {14., 20.},
      RoundingRadius->0], RectangleBox[{14., 0}, {14.5, 6.},
      RoundingRadius->
       0]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0.21999999999999997`, 0},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  PlotRange->{{0.5, 14.5}, {All, All}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.6718135661971226`*^9, 3.6718818333528795`*^9, 
  3.6718828214064193`*^9, 3.671885850897069*^9, 3.6720590265750027`*^9, 
  3.839483692845377*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"f594f259-beca-425b-b806-b09eeea7004a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "\<\"ID\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\<\"year\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "\<\"sample\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "\<\"Species\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "\<\"trunk\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "\<\"Datelist\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "\<\"Log spores/cm2/h\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "\<\"std prop night\"\>"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6718135661971226`*^9, 3.6718818333528795`*^9, 
  3.6718828214064193`*^9, 3.671885850897069*^9, 3.6720590265750027`*^9, 
  3.839483692850371*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"71e28a59-b27e-4035-adae-a1c7c19fb9a2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "\<\"Trunk nbr\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\<\"Log basal diameter (cm)(2009)\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "\<\"Mean decay class (2009)\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "\<\"Tree sp\"\>"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6718135661971226`*^9, 3.6718818333528795`*^9, 
  3.6718828214064193`*^9, 3.671885850897069*^9, 3.6720590265750027`*^9, 
  3.839483692853362*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"0e85562a-5fad-4268-9635-f7fd1248c8e9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "\<\"DateList\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\<\"Year (0=2009,1=2010)\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "\<\"Day nbr\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "\<\"Rain in last 24h?\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "\<\"Residual RH (vs. day nbr)\"\>"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6718135661971226`*^9, 3.6718818333528795`*^9, 
  3.6718828214064193`*^9, 3.671885850897069*^9, 3.6720590265750027`*^9, 
  3.8394836928553567`*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"feb0ecb4-cbba-46fa-9e73-fe6cae7cf7f8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "\<\"Species\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "\<\"Log vol\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "\<\"Growth form (0=res, 1=pil)\"\>"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6718135661971226`*^9, 3.6718818333528795`*^9, 
  3.6718828214064193`*^9, 3.671885850897069*^9, 3.6720590265750027`*^9, 
  3.839483692857362*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"4e8c6397-02b7-4628-a7e4-d65601eb04c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"m", "=", 
    RowBox[{"Length", "[", "species", "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"nbr", " ", "of", " ", "species"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g", "=", "13"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"nbr", " ", "of", " ", "sp", " ", "level", " ", "covariates", " ", 
    RowBox[{"(", 
     RowBox[{"environmental", " ", "effects"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{" ", "1", ")"}], "spruce"}], ",", " ", "2"}], 
                    ")"}], "pine"}], ",", " ", "3"}], ")"}], "birch"}], ",", 
                    " ", "4"}], ")"}], "aspen"}], ",", " ", "5"}], ")"}], 
                    "log", " ", "basal", " ", "diameter"}], ",", " ", "6"}], 
                    ")"}], "decay", " ", "class"}], ",", " ", "7"}], ")"}], 
                    "decay", " ", 
                    RowBox[{"class", "^", "2"}]}], ",", " ", "8"}], ")"}], 
                    "year"}], ",", " ", "9"}], ")"}], "calendar", " ", 
                 "day"}], ",", " ", "10"}], ")"}], "calendar", " ", 
              RowBox[{"day", "^", "2"}]}], ",", " ", "11"}], ")"}], 
           "precipitation"}], ",", " ", "12"}], ")"}], "RH"}], ",", " ", 
       "13"}], ")"}], "proportion", " ", "of", " ", "night"}], "-", 
    RowBox[{"time", " ", 
     RowBox[{"(", 
      RowBox[{
      "\[Theta]\[Lambda]h1", ",", "\[Ellipsis]", ",", "\[Theta]\[Lambda]h7", 
       ",", "\[Ellipsis]", ",", "\[Theta]\[Delta]h1", ",", "\[Ellipsis]", ",",
        "\[Theta]\[Delta]h5", ",", "\[Eta]h"}], ")"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"specieswise", "=", 
   RowBox[{"Split", "[", 
    RowBox[{
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Rest", "[", "stdsamples", "]"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "&"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "==", 
       RowBox[{"#2", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"speciestrunkwise", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Split", "[", 
      RowBox[{
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"specieswise", "[", 
          RowBox[{"[", "h", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "&"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "[", 
          RowBox[{"[", "5", "]"}], "]"}], "==", 
         RowBox[{"#2", "[", 
          RowBox[{"[", "5", "]"}], "]"}]}], "&"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"speciesdaywise", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Split", "[", 
      RowBox[{
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"specieswise", "[", 
          RowBox[{"[", "h", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "&"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "[", 
          RowBox[{"[", "6", "]"}], "]"}], "==", 
         RowBox[{"#2", "[", 
          RowBox[{"[", "6", "]"}], "]"}]}], "&"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"l", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Length", ",", "speciestrunkwise"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "nbr", " ", "of", " ", "occupied", " ", "logs", " ", "for", " ", "each", 
    " ", "sp"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Length", ",", "speciesdaywise"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "nbr", " ", "of", " ", "monitoring", " ", "days", " ", "on", " ", "which", 
    " ", "each", " ", "sp", " ", "was", " ", "observed"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Length", ",", "specieswise"}], "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
   "nbr", " ", "of", " ", "observations", " ", "for", " ", "each", " ", 
    "spp"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"trunkspersp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"speciestrunkwise", "[", 
       RowBox[{"[", "h", "]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1", ",", "5"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dayspersp", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"speciesdaywise", "[", 
        RowBox[{"[", "h", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", "6"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Printing", " ", "a", " ", "matrix", " ", "showing", " ", "the", " ", 
     "number", " ", "of", " ", "obseravations"}], ",", " ", 
    RowBox[{
    "trunks", " ", "and", " ", "sampling", " ", "days", " ", "for", " ", 
     "each", " ", "species"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Prepend", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"species", ",", "n", ",", "l", ",", "d"}], "}"}], "]"}], 
          ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ">", 
            RowBox[{"#2", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "m"}], "}"}]}], "]"}]}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<i\>\"", ",", "\"\<species\>\"", ",", "\"\<# obs\>\"", ",", 
      "\"\<# logs\>\"", ",", "\"\<# days\>\""}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.671804867080052*^9, 3.671804917500641*^9}, {
   3.6718050609661083`*^9, 3.671805061197517*^9}, {3.6718050993199644`*^9, 
   3.6718051093335524`*^9}, {3.6718060858027744`*^9, 
   3.6718060859561296`*^9}, {3.6718062871562996`*^9, 
   3.6718062895593586`*^9}, {3.671813333047518*^9, 3.6718133331946545`*^9}, {
   3.671813587541086*^9, 3.671813587841662*^9}, {3.6718136405419407`*^9, 
   3.6718136638196244`*^9}, 3.671881933101781*^9, {3.6718819850540705`*^9, 
   3.671881997156048*^9}, {3.8782645509081197`*^9, 3.8782645870585885`*^9}, {
   3.8782647810474386`*^9, 
   3.8782647852340784`*^9}},ExpressionUUID->"2dc483dc-2e34-4ffc-b29c-\
4ca50d8727f9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"i\"\>", "\<\"species\"\>", "\<\"# obs\"\>", "\<\"# logs\"\>", \
"\<\"# days\"\>"},
     {"1", "\<\"Fomitopsis pinicola\"\>", "584", "38", "35"},
     {"2", "\<\"Antrodia serialis\"\>", "271", "17", "31"},
     {"3", "\<\"Trichaptum abietinum\"\>", "215", "11", "25"},
     {"4", "\<\"Phellinus tremulae\"\>", "210", "10", "33"},
     {"5", "\<\"Fomes fomentarius\"\>", "187", "16", "34"},
     {"6", "\<\"Antrodia sinuosa\"\>", "143", "17", "34"},
     {"7", "\<\"Scytinostroma galactinum\"\>", "111", "9", "28"},
     {"8", "\<\"Phellinus ferrugineofuscus\"\>", "105", "5", "24"},
     {"9", "\<\"Ganoderma applanatum\"\>", "77", "4", "26"},
     {"10", "\<\"Skeletocutis biguttulata\"\>", "57", "7", "27"},
     {"11", "\<\"Phellinus igniarius\"\>", "47", "3", "16"},
     {"12", "\<\"Phellinus lundellii\"\>", "41", "2", "14"},
     {"13", "\<\"Phellinus viticola\"\>", "30", "1", "12"},
     {"14", "\<\"Hyphodontia breviseta\"\>", "30", "16", "18"},
     {"15", "\<\"Stereum rugosum\"\>", "29", "7", "15"},
     {"16", "\<\"Crustoderma corneum\"\>", "29", "3", "17"},
     {"17", "\<\"Phellinus laevigatus\"\>", "26", "1", "12"},
     {"18", "\<\"Skeletocutis stellae\"\>", "24", "1", "11"},
     {"19", "\<\"Resinicium bicolor\"\>", "24", "15", "15"},
     {"20", "\<\"Datronia mollis\"\>", "24", "3", "17"},
     {"21", "\<\"Skeletocutis amorpha\"\>", "23", "4", "18"},
     {"22", "\<\"Sistotrema raduloides\"\>", "23", "6", "9"},
     {"23", "\<\"Antrodia macra\"\>", "22", "2", "12"},
     {"24", "\<\"Skeletocutis carneogrisea\"\>", "20", "6", "12"},
     {"25", "\<\"Hyphodontia aspera\"\>", "20", "7", "12"},
     {"26", "\<\"Postia caesia\"\>", "18", "6", "7"},
     {"27", "\<\"Antrodiella citrinella\"\>", "18", "4", "12"},
     {"28", "\<\"Trametes ochracea\"\>", "16", "6", "14"},
     {"29", "\<\"Stereum hirsutum\"\>", "14", "2", "9"},
     {"30", "\<\"Rhodonia placenta\"\>", "14", "6", "9"},
     {"31", "\<\"Postia tephroleuca\"\>", "14", "6", "7"},
     {"32", "\<\"Ceriporia excelsa\"\>", "11", "3", "10"},
     {"33", "\<\"Rigidoporus corticola\"\>", "10", "3", "6"},
     {"34", "\<\"Pseudomerulius aureus\"\>", "10", "2", "9"},
     {"35", "\<\"Phellinus nigrolimitatus\"\>", "10", "1", "10"},
     {"36", "\<\"Gloeocystidiellum convolvens\"\>", "10", "3", "5"},
     {"37", "\<\"Skeletocutis papyracea\"\>", "9", "3", "9"},
     {"38", "\<\"Pycnoporellus fulgens\"\>", "9", "5", "7"},
     {"39", "\<\"Porpomyces mucidus\"\>", "9", "1", "9"},
     {"40", "\<\"Phlebia tremellosa\"\>", "9", "3", "5"},
     {"41", "\<\"Bjerkandera adusta\"\>", "9", "1", "7"},
     {"42", "\<\"Asterodon ferruginosus\"\>", "9", "1", "9"},
     {"43", "\<\"Antrodia xantha\"\>", "9", "2", "8"},
     {"44", "\<\"Phlebia fuscoatra\"\>", "8", "5", "7"},
     {"45", "\<\"Junghuhnia luteoalba\"\>", "8", "1", "5"},
     {"46", "\<\"Peniophora laurentii\"\>", "7", "1", "3"},
     {"47", "\<\"Scytinostroma odoratum\"\>", "6", "3", "4"},
     {"48", "\<\"Resinicium furfuraceum\"\>", "6", "2", "4"},
     {"49", "\<\"Postia leucomallella\"\>", "6", "2", "2"},
     {"50", "\<\"Perenniporia subacida\"\>", "6", "1", "6"},
     {"51", "\<\"Ischnoderma benzoinum\"\>", "6", "3", "6"},
     {"52", "\<\"Skeletocutis nivea\"\>", "5", "1", "5"},
     {"53", "\<\"Peniophora incarnata\"\>", "5", "2", "5"},
     {"54", "\<\"Protomerulius caryae\"\>", "4", "1", "4"},
     {"55", "\<\"Postia fragilis\"\>", "4", "2", "3"},
     {"56", "\<\"Phlebia radiata\"\>", "4", "1", "2"},
     {"57", "\<\"Hyphodontia curvispora\"\>", "4", "1", "4"},
     {"58", "\<\"Hyphodontia barba-jovis\"\>", "4", "1", "4"},
     {"59", "\<\"Hyphodontia alutacea\"\>", "4", "3", "4"},
     {"60", "\<\"Ceriporiopsis pseudogilvescens\"\>", "4", "1", "4"},
     {"61", "\<\"Ceraceomyces tessulatus\"\>", "4", "2", "3"},
     {"62", "\<\"Amylostereum chailletii\"\>", "4", "1", "4"},
     {"63", "\<\"Serpula himantioides\"\>", "3", "1", "1"},
     {"64", "\<\"Phlebia subulata\"\>", "3", "2", "3"},
     {"65", "\<\"Phanerochaete sordida\"\>", "3", "2", "3"},
     {"66", "\<\"Hypochnicium eichleri\"\>", "3", "1", "2"},
     {"67", "\<\"Ceriporia viridans\"\>", "3", "1", "3"},
     {"68", "\<\"Trechispora hymenocystis\"\>", "2", "2", "2"},
     {"69", "\<\"Phlebia serialis\"\>", "2", "2", "2"},
     {"70", "\<\"Phlebia gigantea\"\>", "2", "1", "2"},
     {"71", "\<\"Phanerochaete velutina\"\>", "2", "2", "2"},
     {"72", "\<\"Oligoporus sericeomollis\"\>", "2", "1", "2"},
     {"73", "\<\"Leptoporus mollis\"\>", "2", "1", "2"},
     {"74", "\<\"Hyphoderma setigerum\"\>", "2", "2", "2"},
     {"75", "\<\"Gloiothele citrina\"\>", "2", "1", "2"},
     {"76", "\<\"Coniophora puteana\"\>", "2", "2", "2"},
     {"77", "\<\"Ceriporia reticulata\"\>", "2", "2", "2"},
     {"78", "\<\"Antrodiella romellii\"\>", "2", "2", "2"},
     {"79", "\<\"Antrodiella pallescens\"\>", "2", "1", "2"},
     {"80", "\<\"Tubulicrinis subulatus\"\>", "1", "1", "1"},
     {"81", "\<\"Trametes pubescens\"\>", "1", "1", "1"},
     {"82", "\<\"Steccherinum ochraceum\"\>", "1", "1", "1"},
     {"83", "\<\"Steccherinum fimbriatum\"\>", "1", "1", "1"},
     {"84", "\<\"Pseudochaete tabacina\"\>", "1", "1", "1"},
     {"85", "\<\"Postia stiptica\"\>", "1", "1", "1"},
     {"86", "\<\"Porotheleum fimbriatum\"\>", "1", "1", "1"},
     {"87", "\<\"Polyporus leptocephalus\"\>", "1", "1", "1"},
     {"88", "\<\"Phlebiella pseudotsugae\"\>", "1", "1", "1"},
     {"89", "\<\"Phlebia rufa\"\>", "1", "1", "1"},
     {"90", "\<\"Leucogyrophana sororia\"\>", "1", "1", "1"},
     {"91", "\<\"Hyphodontia subalutacea\"\>", "1", "1", "1"},
     {"92", "\<\"Hyphodontia abieticola\"\>", "1", "1", "1"},
     {"93", "\<\"Hyphoderma cremeoalbum\"\>", "1", "1", "1"},
     {"94", "\<\"Gloeoporus pannocinctus\"\>", "1", "1", "1"},
     {"95", "\<\"Gloeophyllum sepiarium\"\>", "1", "1", "1"},
     {"96", "\<\"Cylindrobasidium evolvens\"\>", "1", "1", "1"},
     {"97", "\<\"Ceraceomyces microsporus\"\>", "1", "1", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.671882000490244*^9, 3.6718828259973354`*^9, 
  3.671885855156299*^9, 
  3.672059032325489*^9},ExpressionUUID->"c8f125a8-1623-459f-9c0e-\
097a654910a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Histograms", " ", "of", " ", "the", " ", "species"}], "-", 
     RowBox[{"specific", " ", "sample", " ", "sizes"}]}], ",", " ", 
    RowBox[{
    "trunk", " ", "numbers", " ", "and", " ", "sampling", " ", "day", " ", 
     "numbers"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Histogram", "[", 
     RowBox[{"n", ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
    RowBox[{"Histogram", "[", 
     RowBox[{"l", ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
    RowBox[{"Histogram", "[", 
     RowBox[{"d", ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6718059141782465`*^9, 3.6718059376328354`*^9}, {
  3.6718060402113547`*^9, 3.671806057361661*^9}, {3.6718062216693516`*^9, 
  3.671806223803358*^9}, {3.8782646207630854`*^9, 
  3.8782646548740416`*^9}},ExpressionUUID->"70721385-b367-408b-93de-\
6b1d547aca38"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[{
     {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
      Opacity[0.287], Thickness[Small]}], {}, 
      {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], 
       EdgeForm[{Opacity[0.287], Thickness[Small]}], RectangleBox[{0., 0}, {10., 61},
        RoundingRadius->0], RectangleBox[{10., 0}, {20., 11},
        RoundingRadius->0], RectangleBox[{20., 0}, {30., 11},
        RoundingRadius->0], RectangleBox[{30., 0}, {40., 2},
        RoundingRadius->0], RectangleBox[{40., 0}, {50., 2},
        RoundingRadius->0], RectangleBox[{50., 0}, {60., 1},
        RoundingRadius->0], RectangleBox[{70., 0}, {80., 1},
        RoundingRadius->0], RectangleBox[{100., 0}, {110., 1},
        RoundingRadius->0], RectangleBox[{110., 0}, {120., 1},
        RoundingRadius->0], RectangleBox[{140., 0}, {150., 1},
        RoundingRadius->0], RectangleBox[{180., 0}, {190., 1},
        RoundingRadius->0], RectangleBox[{210., 0}, {220., 2},
        RoundingRadius->0], RectangleBox[{270., 0}, {280., 1},
        RoundingRadius->0], RectangleBox[{580., 0}, {590., 1},
        RoundingRadius->
         0]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{-11.8, 0},
    FrameLabel->{{None, None}, {None, None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    PlotRange->{{0., 590.}, {All, All}},
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.02], 
       Scaled[0.05]}},
    Ticks->{Automatic, Automatic}], ",", 
   GraphicsBox[{
     {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
      Opacity[0.5599999999999999], Thickness[Small]}], {}, 
      {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], 
       EdgeForm[{Opacity[0.5599999999999999], Thickness[Small]}], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{0., 0}, {2., 43}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{12.430147058823527`, 
            18.724264705882348`}, {-40.81543285502586, 30.4375}}],
          StatusArea[#, 43]& ,
          TagBoxNote->"43"],
         StyleBox["43", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[43, {}], "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{2., 0}, {4., 30}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{18.349264705882348`, 
            24.643382352941174`}, {-19.38722059652967, 30.437500000000004`}}],
          StatusArea[#, 30]& ,
          TagBoxNote->"30"],
         StyleBox["30", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[30, {}], "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{4., 0}, {6., 6}, "RoundingRadius" -> 0]},
           ImageSizeCache->{{24.268382352941174`, 30.562499999999993`}, {
            20.17255588069407, 30.437500000000004`}}],
          StatusArea[#, 6]& ,
          TagBoxNote->"6"],
         StyleBox["6", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[6, {}], "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{6., 0}, {8., 9}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{30.187499999999993`, 36.48161764705882}, {
            15.227583821041103`, 30.437500000000004`}}],
          StatusArea[#, 9]& ,
          TagBoxNote->"9"],
         StyleBox["9", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[9, {}], "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{8., 0}, {10., 1}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{36.10661764705882, 42.40073529411764}, {
            28.41417598011568, 30.437500000000004`}}],
          StatusArea[#, 1]& ,
          TagBoxNote->"1"],
         StyleBox["1", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[1, {}], "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{10., 0}, {12., 2}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{42.02573529411764, 48.319852941176464`}, {
            26.76585196023136, 30.437500000000004`}}],
          StatusArea[#, 2]& ,
          TagBoxNote->"2"],
         StyleBox["2", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[2, {}], "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{14., 0}, {16., 1}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{53.86397058823528, 60.15808823529411}, {
            28.41417598011568, 30.437500000000004`}}],
          StatusArea[#, 1]& ,
          TagBoxNote->"1"],
         StyleBox["1", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[1, {}], "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{16., 0}, {18., 4}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{59.78308823529411, 66.07720588235293}, {
            23.469203920462714`, 30.437500000000004`}}],
          StatusArea[#, 4]& ,
          TagBoxNote->"4"],
         StyleBox["4", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[4, {}], "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{38., 0}, {40., 1}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{124.89338235294115`, 131.18749999999997`}, {
            28.41417598011568, 30.437500000000004`}}],
          StatusArea[#, 1]& ,
          TagBoxNote->"1"],
         StyleBox["1", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[1, {}], 
         "Tooltip"]& ]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{-0.8, 0},
    FrameLabel->{{None, None}, {None, None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    PlotRange->{{0., 40.}, {All, All}},
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.02], 
       Scaled[0.05]}},
    Ticks->{Automatic, Automatic}], ",", 
   GraphicsBox[{
     {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], EdgeForm[{
      Opacity[0.644], Thickness[Small]}], {}, 
      {RGBColor[0.987148, 0.8073604000000001, 0.49470040000000004`], 
       EdgeForm[{Opacity[0.644], Thickness[Small]}], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{0., 0}, {5., 48}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{12.430147058823529`, 
            27.602941176470587`}, {-38.81543285502586, 32.4375}}],
          StatusArea[#, 48]& ,
          TagBoxNote->"48"],
         StyleBox["48", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[48, {}], "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{5., 0}, {10., 21}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{27.227941176470587`, 42.400735294117645`}, {
            1.0534043759261884`, 32.4375}}],
          StatusArea[#, 21]& ,
          TagBoxNote->"21"],
         StyleBox["21", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[21, {}], "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{10., 0}, {15., 11}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{42.025735294117645`, 57.1985294117647}, {
            15.819640387389907`, 32.4375}}],
          StatusArea[#, 11]& ,
          TagBoxNote->"11"],
         StyleBox["11", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[11, {}], "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{15., 0}, {20., 7}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{56.8235294117647, 71.99632352941177}, {
            21.726134791975397`, 32.4375}}],
          StatusArea[#, 7]& ,
          TagBoxNote->"7"],
         StyleBox["7", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[7, {}], "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{20., 0}, {25., 1}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{71.62132352941177, 86.79411764705881}, {
            30.585876398853628`, 32.4375}}],
          StatusArea[#, 1]& ,
          TagBoxNote->"1"],
         StyleBox["1", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[1, {}], "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{25., 0}, {30., 4}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{86.41911764705881, 101.59191176470588`}, {
            26.156005595414513`, 32.4375}}],
          StatusArea[#, 4]& ,
          TagBoxNote->"4"],
         StyleBox["4", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[4, {}], "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{30., 0}, {35., 4}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{101.21691176470588`, 116.38970588235293`}, {
            26.156005595414513`, 32.4375}}],
          StatusArea[#, 4]& ,
          TagBoxNote->"4"],
         StyleBox["4", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[4, {}], "Tooltip"]& ], 
       TagBox[
        TooltipBox[
         TagBox[
          DynamicBox[{
            FEPrivate`If[
             CurrentValue["MouseOver"], 
             EdgeForm[{
               GrayLevel[0.5], 
               AbsoluteThickness[1.5], 
               Opacity[0.66]}], {}, {}], 
            RectangleBox[{35., 0}, {40., 1}, "RoundingRadius" -> 0]},
           
           ImageSizeCache->{{116.01470588235293`, 131.1875}, {
            30.585876398853628`, 32.4375}}],
          StatusArea[#, 1]& ,
          TagBoxNote->"1"],
         StyleBox["1", {}, StripOnInput -> False]],
        Annotation[#, 
         Style[1, {}], 
         "Tooltip"]& ]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}}},
    AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
    Axes->{True, True},
    AxesLabel->{None, None},
    AxesOrigin->{-0.8, 0},
    FrameLabel->{{None, None}, {None, None}},
    FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
    GridLines->{None, None},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    PlotRange->{{0., 40.}, {All, All}},
    PlotRangePadding->{{
       Scaled[0.02], 
       Scaled[0.02]}, {
       Scaled[0.02], 
       Scaled[0.05]}},
    Ticks->{Automatic, Automatic}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6718059204308248`*^9, 3.6718059382491198`*^9}, {
   3.6718060480019283`*^9, 3.6718060579776497`*^9}, 3.671806226059663*^9, 
   3.671882010437919*^9, 3.671882831996243*^9, 
   3.6718858581077633`*^9},ExpressionUUID->"8a953c4a-0e73-4d94-94a2-\
4ae421846385"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**"}], "*****)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"**", "Covariates"}], " ", "&"}], " ", "design", " ", 
    "matrices"}], "***)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**"}], "*****)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"g", "+", 
        RowBox[{"l", "[", 
         RowBox[{"[", "h", "]"}], "]"}], "+", 
        RowBox[{"d", "[", 
         RowBox[{"[", "h", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "nbr", " ", "of", " ", "sp", " ", "level", " ", "variables", " ", "for", 
      " ", "each", " ", 
      RowBox[{"species", ":", " ", 
       RowBox[{
        RowBox[{
        "regression", " ", "coefficients", " ", "for", " ", "environmental", 
         " ", "effects"}], " ", "+", " ", 
        RowBox[{"log", " ", "random", " ", "effects"}], " ", "+", " ", 
        RowBox[{"day", " ", "random", " ", "effects"}]}]}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"ftot", "=", 
     RowBox[{"Total", "[", "f", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Include", " ", "values", " ", "of", " ", "the", " ", "log"}], 
     "-", 
     RowBox[{
     "level", " ", "covariates", " ", "for", " ", "the", " ", "occupied", " ",
       "logs", " ", "for", " ", "each", " ", "sp"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{" ", "1", ")"}], "spruce"}], ",", " ", "2"}], 
                    ")"}], "pine"}], ",", " ", "3"}], ")"}], "birch"}], ",", 
                " ", "4"}], ")"}], "aspen"}], ",", " ", "5"}], ")"}], "log", 
           " ", "basal", " ", "diameter"}], ",", " ", "6"}], ")"}], "decay", 
        " ", "class"}], ",", " ", "7"}], ")"}], "decay", " ", 
     RowBox[{"class", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Note", ":", " ", 
       RowBox[{
       "Finnish", " ", "tree", " ", "species", " ", "names", " ", "in", " ", 
        "the", " ", "data"}], ":", " ", "kuusi"}], "=", "spruce"}], ",", " ", 
     RowBox[{"m\[ADoubleDot]nty", "=", "pine"}], ",", " ", 
     RowBox[{"koivu", "=", "birch"}], ",", " ", 
     RowBox[{"haapa", "=", "aspen"}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"logvarrow", "[", "lrow_", "]"}], ":=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"lrow", "[", 
          RowBox[{"[", "4", "]"}], "]"}], ",", "\"\<kuusi\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         "\"\<m\[ADoubleDot]nty\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
         "\"\<koivu\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
         "\"\<haapa\>\"", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lrow", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"lrow", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"lrow", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Include", " ", "values", " ", "of", " ", "the", " ", "day"}], 
     "-", 
     RowBox[{
     "level", " ", "covariates", " ", "for", " ", "the", " ", "occupied", " ",
       "days", " ", "for", " ", "each", " ", "sp"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{" ", "8", ")"}], "year"}], ",", " ", "9"}], ")"}], 
               "calendar", " ", "day"}], ",", " ", "10"}], ")"}], "calendar", 
            " ", 
            RowBox[{"day", "^", "2"}]}], ",", " ", "11"}], ")"}], 
         "precipitation"}], ",", " ", "12"}], ")"}], "RH"}], ","}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dayvarrow", "[", "drow_", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"drow", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"drow", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"drow", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], ",", 
       RowBox[{"drow", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{"drow", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Include", " ", "values", " ", "of", " ", "the", " ", "sample"}],
      "-", 
     RowBox[{
     "level", " ", "covariates", " ", "for", " ", "the", " ", "observations", 
      " ", "of", " ", "each", " ", "sp"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{" ", "13", ")"}], "proportion", " ", "of", " ", "night"}], "-", 
     "time"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Constructing", " ", "the", " ", "design", " ", "matrix", " ", "S"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"logvarrow", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"stdtrunks", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
                 RowBox[{"specieswise", "[", 
                  RowBox[{"[", 
                   RowBox[{"h", ",", "i", ",", "5"}], "]"}], "]"}]}], "&"}]}],
               "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"dayvarrow", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"stddays", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
                 RowBox[{"specieswise", "[", 
                  RowBox[{"[", 
                   RowBox[{"h", ",", "i", ",", "6"}], "]"}], "]"}]}], "&"}]}],
               "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"specieswise", "[", 
             RowBox[{"[", 
              RowBox[{"h", ",", "i", ",", "8"}], "]"}], "]"}], "}"}]}], "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "h", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Constructing", " ", "the", " ", "design", " ", "matrix", " ", "R"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"logvarrow", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"stdtrunks", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
                 RowBox[{"specieswise", "[", 
                  RowBox[{"[", 
                   RowBox[{"h", ",", "i", ",", "5"}], "]"}], "]"}]}], "&"}]}],
               "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"dayvarrow", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{"stddays", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
                 RowBox[{"specieswise", "[", 
                  RowBox[{"[", 
                   RowBox[{"h", ",", "i", ",", "6"}], "]"}], "]"}]}], "&"}]}],
               "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"specieswise", "[", 
             RowBox[{"[", 
              RowBox[{"h", ",", "i", ",", "8"}], "]"}], "]"}], "}"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"specieswise", "[", 
                 RowBox[{"[", 
                  RowBox[{"h", ",", "i", ",", "5"}], "]"}], "]"}], "\[Equal]", 
                RowBox[{"trunkspersp", "[", 
                 RowBox[{"[", 
                  RowBox[{"h", ",", "j"}], "]"}], "]"}]}], ",", "1", ",", 
               "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"trunkspersp", "[", 
                 RowBox[{"[", "h", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"specieswise", "[", 
                 RowBox[{"[", 
                  RowBox[{"h", ",", "i", ",", "6"}], "]"}], "]"}], "\[Equal]", 
                RowBox[{"dayspersp", "[", 
                 RowBox[{"[", 
                  RowBox[{"h", ",", "k"}], "]"}], "]"}]}], ",", "1", ",", 
               "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"dayspersp", "[", 
                 RowBox[{"[", "h", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "h", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Rh", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Sh", ",", "Z\[Lambda]h", ",", "Z\[Delta]h"}], ")"}], " ", 
        "is", " ", "an", " ", "nh", " ", "x", " ", "fh", " ", "design", " ", 
        "matrix", " ", "in", " ", "which", " ", "the", " ", "block", " ", 
        "Sh", " ", 
        RowBox[{"(", 
         RowBox[{"dimensions", " ", "nh", " ", "x", " ", "g"}], ")"}], " ", 
        "contains", " ", "the", " ", "values", " ", "of", " ", "the", " ", 
        "log"}], "-"}]}], ",", 
     RowBox[{"day", "-", 
      RowBox[{"and", " ", "sample"}], "-", 
      RowBox[{"level", " ", "covariates"}]}], ",", 
     RowBox[{"the", " ", "block", " ", "Z\[Lambda]h", " ", 
      RowBox[{"(", 
       RowBox[{"dimensions", " ", "nh", " ", "x", " ", "lh"}], ")"}], " ", 
      "denotes", " ", "the", " ", "log", " ", "corresponding", " ", "to", " ",
       "each", " ", "observation", " ", "and", " ", "the", " ", "block", " ", 
      "Z\[Delta]h", " ", 
      RowBox[{"(", 
       RowBox[{"dimensions", " ", "nh", " ", "x", " ", "dh"}], ")"}], " ", 
      "denotes", " ", "the", " ", "day", " ", "corresponding", " ", "to", " ",
       "each", " ", 
      RowBox[{"observation", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"traits", "=", 
     RowBox[{
      RowBox[{"Rest", "[", "stdtraits", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"2", ";;", "3"}]}], "]"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"1", ")"}], "log", " ", "spore", " ", "vol"}], ",", " ", 
        "2"}], ")"}], 
      RowBox[{"pil", "/", "res"}]}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Xmatrix", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"kk", "\[Equal]", "k"}], ",", "1", ",", 
               RowBox[{"kk", "\[Equal]", 
                RowBox[{"g", "+", "k"}]}], ",", 
               RowBox[{"traits", "[", 
                RowBox[{"[", 
                 RowBox[{"h", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"kk", "\[Equal]", 
                RowBox[{
                 RowBox[{"2", "*", "g"}], "+", "k"}]}], ",", 
               RowBox[{"traits", "[", 
                RowBox[{"[", 
                 RowBox[{"h", ",", "2"}], "]"}], "]"}], " ", ",", "True", ",",
                "0"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"kk", ",", 
               RowBox[{"g", "*", "p"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "g"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"g", "*", "p"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{"l", "[", 
               RowBox[{"[", "h", "]"}], "]"}], "+", 
              RowBox[{"d", "[", 
               RowBox[{"[", "h", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"X", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Xmatrix", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"X", " ", "is", " ", "a", " ", "ftot", " ", "x", " ", 
      RowBox[{"(", 
       RowBox[{"g", "*", "p"}], ")"}], " ", "design", " ", "matrix", " ", 
      "consisting", " ", "of", " ", "m", " ", "blocks", " ", "of", " ", 
      "dimensions", " ", "fh", " ", "x", " ", 
      RowBox[{"(", 
       RowBox[{"g", "*", "p"}], ")"}], " ", "corresponding", " ", "to", " ", 
      "each", " ", "species", " ", "h"}], ",", 
     RowBox[{
      RowBox[{
      "where", " ", "the", " ", "first", " ", "g", " ", "rows", " ", "of", 
       " ", "the", " ", "block", " ", "contain", " ", "the", " ", "values", 
       " ", "of", " ", "the", " ", "species"}], "-", 
      RowBox[{
      "specific", " ", "trait", " ", "covariates", " ", "for", " ", "species",
        " ", "h", " ", "and", " ", "the", " ", "subsequent", " ", "lh"}], "+", 
      RowBox[{
      "dh", " ", "rows", " ", "are", " ", "zeros", " ", "in", " ", "order", 
       " ", "to", " ", "obtain", " ", "zero", " ", "as", " ", "the", " ", 
       "expected", " ", "value", " ", "for", " ", "each", " ", "random", " ", 
       "log", " ", "and", " ", "day", " ", 
       RowBox[{"effect", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"y", "=", 
     RowBox[{"specieswise", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "All", ",", "7"}], "]"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.651467801488574*^9, {3.651468565717146*^9, 3.651468566447147*^9}, {
   3.6514687381173873`*^9, 3.651468738637388*^9}, {3.651469235238083*^9, 
   3.651469235528084*^9}, {3.6514693020191765`*^9, 3.651469302659178*^9}, {
   3.651545867209137*^9, 3.6515458713791428`*^9}, {3.651546096229458*^9, 
   3.6515460966694584`*^9}, {3.651546860685532*^9, 3.6515468617555337`*^9}, {
   3.6515494916107483`*^9, 3.6515494928507504`*^9}, {3.6515495299808025`*^9, 
   3.6515495309608035`*^9}, {3.659259356812557*^9, 3.659259476027376*^9}, {
   3.6592596904096375`*^9, 3.659259691550703*^9}, {3.659264329789995*^9, 
   3.659264394224681*^9}, {3.6592644553231754`*^9, 3.659264457765315*^9}, {
   3.671804745432564*^9, 3.671804752956852*^9}, {3.6718051151432395`*^9, 
   3.6718051240553074`*^9}, {3.671805158141251*^9, 3.6718051619465327`*^9}, 
   3.67180610096014*^9, {3.671806246907593*^9, 3.6718062691837435`*^9}, {
   3.6718074037511854`*^9, 3.6718074075557466`*^9}, {3.671807783981326*^9, 
   3.6718077994739065`*^9}, {3.671813487993476*^9, 3.6718135113278246`*^9}, 
   3.671813684389176*^9, {3.6718149133991523`*^9, 3.6718149137465444`*^9}, {
   3.8782646892033925`*^9, 3.8782647662610807`*^9}, 3.878264857906391*^9, {
   3.878265105643592*^9, 
   3.878265184727851*^9}},ExpressionUUID->"f736ec5f-bcc0-4500-b5d3-\
24d3a1d8e8cc"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**"}], "*", "*", 
    RowBox[{"**", "**", "**", "**", "**"}]}], "*****)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "True", " ", "values", " ", "of", " ", "estimated", " ", "parameters"}], 
     " ", "&"}], " ", "generated", " ", "data"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Used", " ", "for", " ", "testing", " ", "that", " ", "the", " ", "MCMC", 
    " ", "finds", " ", "the", " ", "correct", " ", "values"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**"}], "*", "*", 
    RowBox[{"**", "**"}]}], "*****)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t0", "=", "3"}], ";", "\[IndentingNewLine]", 
    RowBox[{"sigma20", "=", 
     RowBox[{"IdentityMatrix", "[", "1", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"tau2lambda", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"WishartDistribution", "[", 
          RowBox[{"sigma20", ",", 
           RowBox[{"t0", "+", "1"}]}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"true", " ", "variance", " ", "between", " ", "logs"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"tau2delta", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"WishartDistribution", "[", 
          RowBox[{"sigma20", ",", 
           RowBox[{"t0", "+", "1"}]}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"true", " ", "variance", " ", "between", " ", "days"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"sigma2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", 
         RowBox[{"WishartDistribution", "[", 
          RowBox[{"sigma20", ",", 
           RowBox[{"t0", "+", "1"}]}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"true", " ", "variance", " ", "between", " ", "samples"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"lograndomeffs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Random", "[", 
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"tau2lambda", "[", 
              RowBox[{"[", "h", "]"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"l", "[", 
            RowBox[{"[", "h", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"dayrandomeffs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Random", "[", 
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"tau2delta", "[", 
              RowBox[{"[", "h", "]"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"d", "[", 
            RowBox[{"[", "h", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{"beta", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Random", "[", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"0", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"g", "*", "p"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"SIGMA", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"WishartDistribution", "[", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "g", "]"}], ",", 
        RowBox[{"g", "+", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"delta", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"MultinormalDistribution", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "g"}], "}"}]}], "]"}], ",", "SIGMA"}], "]"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"theta", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Xmatrix", "[", 
            RowBox[{"[", "h", "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", "g"}], ",", "All"}], "]"}], "]"}], ")"}], ".",
          "beta"}], "+", 
        RowBox[{"delta", "[", 
         RowBox[{"[", "h", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"phi", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"theta", "[", 
          RowBox[{"[", "h", "]"}], "]"}], ",", 
         RowBox[{"lograndomeffs", "[", 
          RowBox[{"[", "h", "]"}], "]"}], ",", 
         RowBox[{"dayrandomeffs", "[", 
          RowBox[{"[", "h", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"eps", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"RandomReal", "[", 
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"sigma2", "[", 
              RowBox[{"[", "h", "]"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n", "[", 
            RowBox[{"[", "h", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"y", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"[", "h", "]"}], "]"}], ".", 
         RowBox[{"phi", "[", 
          RowBox[{"[", "h", "]"}], "]"}]}], "+", 
        RowBox[{"eps", "[", 
         RowBox[{"[", "h", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBmIQvUfNZNpRk9eOQv/SZ4Joh5OM30H0pMsPwPT/bc78
x4C07jUHERC94lqFJIhOcs+TAtEX3NXkQfSpb081QPQUr+nBIHqHeEg4iD6x
Z04KiL6yIi0LREtO7SgC0ZPualaD6Ibs/do1zq8dfx1W0gfRF15PSAPRS82U
s0D0s0t1RSB63ct+ML1J1bACRJ983w+mzSzZ5WqB9PLyZHkQfXt1kymIXqvU
CqZ3pQV4gugNJYfA9KsVhWkgetOUZjDterd2CYiekdIBppeI3rsFoiNnHXkA
otvauF+A6GPugm9A9LojS1nqgDRzwCowLSSjLAGif3B+lQLRX2qPqYHopp0X
1SDi4iYgevYvcXMQLZJW5Ccc8NoxYOZdMM1zwDoZRMtMLwfTZaFmN3KjXzsG
pZ4F01FGN01Mnr5xjLmYaAOiAR+T1Ks=
  "],ExpressionUUID->"9d41d839-06d7-4a73-bf66-e6a912cef5c2"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**"}], "*", "*", 
    RowBox[{"**", "**", "**", "**", "**"}]}], "*****)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"**", "**"}], "*", " ", "Prior", " ", "parameters"}], " ", 
     "&"}], " ", "initial", " ", 
    RowBox[{"values", " ", "**", "**", "**"}]}], "*******)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**"}], "*", "*", 
    RowBox[{"**", "**"}]}], "*****)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"t0", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ty", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"t0", "+", 
        RowBox[{"n", "[", 
         RowBox[{"[", "h", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tl", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"t0", "+", 
        RowBox[{"l", "[", 
         RowBox[{"[", "h", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"td", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"t0", "+", 
        RowBox[{"d", "[", 
         RowBox[{"[", "h", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sigma20", "=", 
     RowBox[{"IdentityMatrix", "[", "1", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v0", "=", 
     RowBox[{"g", "+", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v", "=", 
     RowBox[{"v0", "+", "m"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lambda0", "=", 
     RowBox[{"IdentityMatrix", "[", "g", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"phi1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{"0.", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"f", "[", 
            RowBox[{"[", "h", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tau2lambda1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1.", ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"variance", " ", "btw", " ", "logs"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tau2delta1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1.", ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"variance", " ", "btw", " ", "days"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sigma21", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1.", ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"variance", " ", "btw", " ", "samples"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"beta1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0.", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"g", "*", "p"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SIGMA1", "=", 
     RowBox[{"IdentityMatrix", "[", "g", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Z", "=", 
     RowBox[{
      RowBox[{"10", "^", "2"}], "*", 
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{"g", "*", "p"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iZ", "=", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"10", "^", "2"}]}], "*", 
      RowBox[{"IdentityMatrix", "[", 
       RowBox[{"g", "*", "p"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"t0", "+", 
        RowBox[{"n", "[", 
         RowBox[{"[", "h", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ttaulambda", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"t0", "+", 
        RowBox[{"l", "[", 
         RowBox[{"[", "h", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ttaudelta", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"t0", "+", 
        RowBox[{"d", "[", 
         RowBox[{"[", "h", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.54028352546875*^9, 3.5402835275625*^9}, {
   3.540283582953125*^9, 3.54028358321875*^9}, {3.5402837151875*^9, 
   3.54028371790625*^9}, {3.54028382703125*^9, 3.540283844359375*^9}, {
   3.540283882046875*^9, 3.54028391003125*^9}, 3.540284893953125*^9, {
   3.54028564421875*^9, 3.540285659984375*^9}, {3.540285856265625*^9, 
   3.540285858046875*^9}, {3.540285924921875*^9, 3.54028597271875*^9}, {
   3.5402860058125*^9, 3.54028601409375*^9}, {3.540286065296875*^9, 
   3.540286108765625*^9}, {3.540286144390625*^9, 3.54028616253125*^9}, {
   3.540286217234375*^9, 3.54028631290625*^9}, {3.54028646621875*^9, 
   3.540286497984375*^9}, {3.540286644046875*^9, 3.540286675046875*^9}, {
   3.54028673353125*^9, 3.540286736609375*^9}, {3.541328988780375*^9, 
   3.541328991405375*^9}, {3.54132910926475*^9, 3.541329164842875*^9}, {
   3.541330683624125*^9, 3.541330705749125*^9}, {3.54133158551475*^9, 
   3.541331587405375*^9}, {3.5413326579835*^9, 3.54133271920225*^9}, {
   3.5415004285*^9, 3.54150046315625*^9}, {3.54185104671875*^9, 
   3.541851141171875*^9}, {3.541851243828125*^9, 3.541851246671875*^9}, {
   3.541851410046875*^9, 3.541851414234375*^9}, 3.546065650859375*^9, {
   3.659264477121422*^9, 3.6592644820047016`*^9}, {3.659264551230661*^9, 
   3.6592645988703856`*^9}, {3.6655118867819085`*^9, 
   3.6655119051219344`*^9}, {3.6655119457390013`*^9, 
   3.6655119850290565`*^9}, {3.6655121102062426`*^9, 
   3.6655121123762455`*^9}, {3.6655121696463256`*^9, 
   3.6655121701363263`*^9}, {3.665512230844454*^9, 3.665512250174491*^9}, {
   3.665512303753598*^9, 3.6655123204976635`*^9}, {3.6655126418221235`*^9, 
   3.6655126467821302`*^9}, {3.6655128234584*^9, 3.665512870108465*^9}, {
   3.6655129176125364`*^9, 3.6655129184325376`*^9}, {3.6655129999426517`*^9, 
   3.6655131311428356`*^9}, {3.66551326907605*^9, 3.665513270076051*^9}, {
   3.6655133538561893`*^9, 3.6655133633062024`*^9}, {3.6655134335513115`*^9, 
   3.6655134391513186`*^9}, {3.6655135540965843`*^9, 
   3.6655135903666353`*^9}, {3.6655136505797715`*^9, 3.665513665719793*^9}, {
   3.665513708937864*^9, 3.66551371317787*^9}, {3.665934978404123*^9, 
   3.6659349836241302`*^9}, {3.6659351104313383`*^9, 
   3.6659351115813403`*^9}, {3.665943522994357*^9, 3.6659435254543605`*^9}, {
   3.66594503796174*^9, 3.6659450381817403`*^9}, {3.665945068581783*^9, 
   3.665945068801783*^9}, 3.671882171279362*^9},
 CellLabel->"In[70]:=",ExpressionUUID->"74eb1e41-6700-45c3-a2e3-f818184b6013"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**"}], "*", "*", 
    RowBox[{"**", "**", "**", "**", "**"}]}], "*****)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**"}], "*", " ", "Sampling", " ", "the", " ", "posterior", 
    " ", 
    RowBox[{"distributions", " ", "**", "**", "**"}]}], "*******)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**"}], "*", "*", 
    RowBox[{"**", "**"}]}], "*****)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"samples", "=", "10000"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"10000", ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TAphi", "=", 
     RowBox[{"TAtau2lambda", "=", 
      RowBox[{"TAtau2delta", "=", 
       RowBox[{"TAsigma2", "=", 
        RowBox[{"TAbeta", "=", 
         RowBox[{"TASIGMA", "=", 
          RowBox[{"{", "}"}]}]}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iterclock", "=", 
     RowBox[{"CreateDocument", "[", 
      RowBox[{"\"\<\>\"", ",", 
       RowBox[{"WindowSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"200", ",", "200"}], "}"}]}], ",", 
       RowBox[{"WindowTitle", "\[Rule]", "\"\<Iteration clock\>\""}]}], 
      "]"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Window", " ", "showing", " ", "the", " ", "current", " ", "iteration", 
     " ", "of", " ", "the", " ", "MCMC"}], "*)"}], "\[IndentingNewLine]", 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"iterclock", "=", 
       RowBox[{"CreateDocument", "[", 
        RowBox[{"repl", ",", "iterclock"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Sampling", " ", 
        RowBox[{"phi", ":"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"iV", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"f", "[", 
              RowBox[{"[", "h", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"f", "[", 
              RowBox[{"[", "h", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"iSIGMA1", "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"N", "[", "SIGMA1", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"h", "=", "1"}], ",", 
        RowBox[{"h", "\[LessEqual]", "m"}], ",", 
        RowBox[{"h", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"iV", "[", 
           RowBox[{"[", 
            RowBox[{"h", ",", 
             RowBox[{"1", ";;", "g"}], ",", 
             RowBox[{"1", ";;", "g"}]}], "]"}], "]"}], "=", "iSIGMA1"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"iV", "[", 
           RowBox[{"[", 
            RowBox[{"h", ",", 
             RowBox[{
              RowBox[{"g", "+", "1"}], ";;", 
              RowBox[{"g", "+", 
               RowBox[{"l", "[", 
                RowBox[{"[", "h", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"g", "+", "1"}], ";;", 
              RowBox[{"g", "+", 
               RowBox[{"l", "[", 
                RowBox[{"[", "h", "]"}], "]"}]}]}]}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"tau2lambda1", "[", 
             RowBox[{"[", "h", "]"}], "]"}]}], "*", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"l", "[", 
             RowBox[{"[", "h", "]"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"iV", "[", 
           RowBox[{"[", 
            RowBox[{"h", ",", 
             RowBox[{
              RowBox[{"g", "+", 
               RowBox[{"l", "[", 
                RowBox[{"[", "h", "]"}], "]"}], "+", "1"}], ";;", 
              RowBox[{"g", "+", 
               RowBox[{"l", "[", 
                RowBox[{"[", "h", "]"}], "]"}], "+", 
               RowBox[{"d", "[", 
                RowBox[{"[", "h", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"g", "+", 
               RowBox[{"l", "[", 
                RowBox[{"[", "h", "]"}], "]"}], "+", "1"}], ";;", 
              RowBox[{"g", "+", 
               RowBox[{"l", "[", 
                RowBox[{"[", "h", "]"}], "]"}], "+", 
               RowBox[{"d", "[", 
                RowBox[{"[", "h", "]"}], "]"}]}]}]}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"tau2delta1", "[", 
             RowBox[{"[", "h", "]"}], "]"}]}], "*", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"d", "[", 
             RowBox[{"[", "h", "]"}], "]"}], "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"iU", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"sigma21", "[", 
            RowBox[{"[", "h", "]"}], "]"}]}], "*", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"n", "[", 
            RowBox[{"[", "h", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"iU", "   ", "Uh"}], "=", 
        RowBox[{"\[Sigma]h2I_", 
         RowBox[{"(", "n_h", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mu", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Xmatrix", "[", 
           RowBox[{"[", "h", "]"}], "]"}], ".", "beta1"}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"iQ", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"R", "[", 
             RowBox[{"[", "h", "]"}], "]"}], "]"}], ".", 
           RowBox[{"iU", "[", 
            RowBox[{"[", "h", "]"}], "]"}], ".", 
           RowBox[{"R", "[", 
            RowBox[{"[", "h", "]"}], "]"}]}], "+", 
          RowBox[{"iV", "[", 
           RowBox[{"[", "h", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Inverse", "[", 
          RowBox[{"iQ", "[", 
           RowBox[{"[", "h", "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Q", "[", 
             RowBox[{"[", "h", "]"}], "]"}], "+", 
            RowBox[{"Transpose", "[", 
             RowBox[{"Q", "[", 
              RowBox[{"[", "h", "]"}], "]"}], "]"}]}], ")"}], "/", "2"}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Q", "[", 
           RowBox[{"[", "h", "]"}], "]"}], ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"R", "[", 
               RowBox[{"[", "h", "]"}], "]"}], "]"}], ".", 
             RowBox[{"iU", "[", 
              RowBox[{"[", "h", "]"}], "]"}], ".", 
             RowBox[{"y", "[", 
              RowBox[{"[", "h", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"iV", "[", 
              RowBox[{"[", "h", "]"}], "]"}], ".", 
             RowBox[{"mu", "[", 
              RowBox[{"[", "h", "]"}], "]"}]}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"phi1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"RandomReal", "[", 
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", "h", "]"}], "]"}], ",", 
            RowBox[{"Q", "[", 
             RowBox[{"[", "h", "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Sampling", " ", 
        RowBox[{"beta", ":"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"iW", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "ftot"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "ftot"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ind", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"h", "=", "1"}], ",", 
        RowBox[{"h", "\[LessEqual]", "m"}], ",", 
        RowBox[{"h", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"iW", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"ind", ";;", 
              RowBox[{"ind", "+", 
               RowBox[{"f", "[", 
                RowBox[{"[", "h", "]"}], "]"}], "-", "1"}]}], ",", 
             RowBox[{"ind", ";;", 
              RowBox[{"ind", "+", 
               RowBox[{"f", "[", 
                RowBox[{"[", "h", "]"}], "]"}], "-", "1"}]}]}], "]"}], "]"}], 
          "=", 
          RowBox[{"iV", "[", 
           RowBox[{"[", "h", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ind", "=", 
          RowBox[{"ind", "+", 
           RowBox[{"f", "[", 
            RowBox[{"[", "h", "]"}], "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"iB", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Transpose", "[", "X", "]"}], ".", "iW", ".", "X"}], "+", 
        "iZ"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B", "=", 
       RowBox[{"Inverse", "[", "iB", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"B", "+", 
          RowBox[{"Transpose", "[", "B", "]"}]}], ")"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"B", ".", 
        RowBox[{"Transpose", "[", "X", "]"}], ".", "iW", ".", 
        RowBox[{"Flatten", "[", "phi1", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", "iW", "]"}], ";", 
      RowBox[{"(*", 
       RowBox[{"to", " ", "speed", " ", "up"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"beta1", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"MultinormalDistribution", "[", 
         RowBox[{"b", ",", "B"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Sampling", " ", 
        RowBox[{"SIGMA", ":"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mu", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Xmatrix", "[", 
           RowBox[{"[", "h", "]"}], "]"}], ".", "beta1"}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"z", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"phi1", "[", 
           RowBox[{"[", 
            RowBox[{"h", ",", 
             RowBox[{"1", ";;", "g"}]}], "]"}], "]"}], "-", 
          RowBox[{"mu", "[", 
           RowBox[{"[", 
            RowBox[{"h", ",", 
             RowBox[{"1", ";;", "g"}]}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"just", " ", "the", " ", "theta", " ", "part"}], "*)"}], "\n", 
      RowBox[{"zmean", "=", 
       RowBox[{
        RowBox[{"1", "/", "m"}], "*", 
        RowBox[{"Total", "[", "z", "]"}]}]}], ";", "\n", 
      RowBox[{"res", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"[", "h", "]"}], "]"}], "-", "zmean"}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lambda", "=", 
       RowBox[{"lambda0", "+", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"res", "[", 
              RowBox[{"[", "h", "]"}], "]"}], "}"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{"res", "[", 
             RowBox[{"[", "h", "]"}], "]"}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ilambda", "=", 
       RowBox[{"Inverse", "[", "lambda", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ilambda", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ilambda", "+", 
          RowBox[{"Transpose", "[", "ilambda", "]"}]}], ")"}], "/", "2"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"SIGMA1", "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"WishartDistribution", "[", 
          RowBox[{"ilambda", ",", "v"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Sampling", " ", 
        RowBox[{"sigma2", ":"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Rphi", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"[", "h", "]"}], "]"}], ".", 
          RowBox[{"phi1", "[", 
           RowBox[{"[", "h", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"[", 
              RowBox[{"h", ",", "k"}], "]"}], "]"}], "-", 
            RowBox[{"Rphi", "[", 
             RowBox[{"[", 
              RowBox[{"h", ",", "k"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"n", "[", 
              RowBox[{"[", "h", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"smean", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"n", "[", 
            RowBox[{"[", "h", "]"}], "]"}]}], "*", 
          RowBox[{"Total", "[", 
           RowBox[{"s", "[", 
            RowBox[{"[", "h", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"scale", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sigma20", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"s", "[", 
                RowBox[{"[", 
                 RowBox[{"h", ",", "k"}], "]"}], "]"}], "-", 
               RowBox[{"smean", "[", 
                RowBox[{"[", "h", "]"}], "]"}]}], ")"}], "^", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"n", "[", 
               RowBox[{"[", "h", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"sigma21", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{"WishartDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"1", "/", 
                 RowBox[{"scale", "[", 
                  RowBox[{"[", "h", "]"}], "]"}]}], "}"}], "}"}], ",", 
              RowBox[{"t", "[", 
               RowBox[{"[", "h", "]"}], "]"}]}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Sampling", " ", 
        RowBox[{"tau2lambda", ":"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"phi1", "[", 
          RowBox[{"[", 
           RowBox[{"h", ",", 
            RowBox[{
             RowBox[{"g", "+", "1"}], ";;", 
             RowBox[{"g", "+", 
              RowBox[{"l", "[", 
               RowBox[{"[", "h", "]"}], "]"}]}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"emean", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"l", "[", 
            RowBox[{"[", "h", "]"}], "]"}]}], "*", 
          RowBox[{"Total", "[", 
           RowBox[{"e", "[", 
            RowBox[{"[", "h", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"tscale", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sigma20", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"e", "[", 
                RowBox[{"[", 
                 RowBox[{"h", ",", "k"}], "]"}], "]"}], "-", 
               RowBox[{"emean", "[", 
                RowBox[{"[", "h", "]"}], "]"}]}], ")"}], "^", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"l", "[", 
               RowBox[{"[", "h", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tau2lambda1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{"WishartDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"1", "/", 
                 RowBox[{"tscale", "[", 
                  RowBox[{"[", "h", "]"}], "]"}]}], "}"}], "}"}], ",", 
              RowBox[{"ttaulambda", "[", 
               RowBox[{"[", "h", "]"}], "]"}]}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Sampling", " ", 
        RowBox[{"tau2delta", ":"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"e", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"phi1", "[", 
          RowBox[{"[", 
           RowBox[{"h", ",", 
            RowBox[{
             RowBox[{"g", "+", 
              RowBox[{"l", "[", 
               RowBox[{"[", "h", "]"}], "]"}], "+", "1"}], ";;", 
             RowBox[{"g", "+", 
              RowBox[{"l", "[", 
               RowBox[{"[", "h", "]"}], "]"}], "+", 
              RowBox[{"d", "[", 
               RowBox[{"[", "h", "]"}], "]"}]}]}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"emean", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"d", "[", 
            RowBox[{"[", "h", "]"}], "]"}]}], "*", 
          RowBox[{"Total", "[", 
           RowBox[{"e", "[", 
            RowBox[{"[", "h", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"tscale", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sigma20", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"e", "[", 
                RowBox[{"[", 
                 RowBox[{"h", ",", "k"}], "]"}], "]"}], "-", 
               RowBox[{"emean", "[", 
                RowBox[{"[", "h", "]"}], "]"}]}], ")"}], "^", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"d", "[", 
               RowBox[{"[", "h", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tau2delta1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{"WishartDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"1", "/", 
                 RowBox[{"tscale", "[", 
                  RowBox[{"[", "h", "]"}], "]"}]}], "}"}], "}"}], ",", 
              RowBox[{"ttaudelta", "[", 
               RowBox[{"[", "h", "]"}], "]"}]}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"TAphi", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"TAphi", ",", "phi1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TAtau2lambda", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"TAtau2lambda", ",", "tau2lambda1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TAtau2delta", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"TAtau2delta", ",", "tau2delta1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TAsigma2", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"TAsigma2", ",", "sigma21"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TAbeta", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"TAbeta", ",", "beta1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TASIGMA", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"TASIGMA", ",", "SIGMA1"}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"repl", ",", "samples"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.54028688634375*^9, 3.540286925515625*^9}, {
   3.5402870956875*^9, 3.540287215640625*^9}, {3.540287661609375*^9, 
   3.540287800375*^9}, {3.540287936609375*^9, 3.540287938234375*^9}, {
   3.540287980234375*^9, 3.540288000703125*^9}, {3.54028803909375*^9, 
   3.54028821065625*^9}, {3.54028826815625*^9, 3.5402883395*^9}, {
   3.540288376890625*^9, 3.540288480328125*^9}, {3.540288703484375*^9, 
   3.540288709890625*^9}, {3.540289109875*^9, 3.540289146296875*^9}, {
   3.54028921165625*^9, 3.5402892131875*^9}, {3.540289779515625*^9, 
   3.540289788875*^9}, {3.540289832984375*^9, 3.540289856328125*^9}, {
   3.540289989875*^9, 3.5402901339375*^9}, {3.54029018428125*^9, 
   3.540290215671875*^9}, {3.540290505078125*^9, 3.54029052115625*^9}, 
   3.540290568390625*^9, {3.540296999953125*^9, 3.540297034265625*^9}, {
   3.540297094125*^9, 3.540297136453125*^9}, {3.540297182734375*^9, 
   3.54029722440625*^9}, {3.54132930020225*^9, 3.54132930101475*^9}, {
   3.541329495374125*^9, 3.541329500592875*^9}, {3.5413295379835*^9, 
   3.541329540686625*^9}, {3.541329597155375*^9, 3.54132961601475*^9}, {
   3.54132972251475*^9, 3.541329744967875*^9}, {3.54133053076475*^9, 
   3.54133055707725*^9}, {3.5413309382335*^9, 3.541330948592875*^9}, {
   3.541331669405375*^9, 3.54133170332725*^9}, {3.54133275876475*^9, 
   3.5413327602335*^9}, {3.5413328651085*^9, 3.541332869421*^9}, {
   3.541332914217875*^9, 3.541333045780375*^9}, {3.54150048540625*^9, 
   3.541500516046875*^9}, {3.541500578859375*^9, 3.541500601953125*^9}, {
   3.541500647015625*^9, 3.5415006489375*^9}, {3.54185151346875*^9, 
   3.541851518734375*^9}, {3.541851558234375*^9, 3.54185159175*^9}, {
   3.54185166384375*^9, 3.541851708328125*^9}, {3.541851759828125*^9, 
   3.54185195065625*^9}, {3.541851994421875*^9, 3.54185201171875*^9}, {
   3.5418521106875*^9, 3.54185215971875*^9}, {3.54185218978125*^9, 
   3.54185237053125*^9}, {3.5418524674375*^9, 3.541852478578125*^9}, {
   3.541852541640625*^9, 3.541852699875*^9}, {3.5418527875*^9, 
   3.541852897015625*^9}, {3.54185293440625*^9, 3.541853064640625*^9}, {
   3.54185352759375*^9, 3.541853529203125*^9}, {3.541853578578125*^9, 
   3.54185358009375*^9}, {3.541853681953125*^9, 3.541853682703125*^9}, {
   3.541853775828125*^9, 3.541853821625*^9}, 3.54185397703125*^9, {
   3.5418542665*^9, 3.541854289875*^9}, {3.541854458453125*^9, 
   3.54185447425*^9}, {3.5418545790625*^9, 3.541854583578125*^9}, {
   3.5418546438125*^9, 3.541854692265625*^9}, {3.541854730359375*^9, 
   3.541854819578125*^9}, 3.541855089*^9, 3.541855211046875*^9, {
   3.5418555568125*^9, 3.54185579903125*^9}, {3.54185610134375*^9, 
   3.5418561113125*^9}, {3.541856157265625*^9, 3.541856184171875*^9}, {
   3.541856357625*^9, 3.541856383625*^9}, {3.541856694859375*^9, 
   3.541856715390625*^9}, {3.541856781140625*^9, 3.541856796125*^9}, {
   3.541862679984375*^9, 3.54186268065625*^9}, 3.546065575515625*^9, {
   3.6655106775780687`*^9, 3.6655106897780857`*^9}, {3.6655137934490232`*^9, 
   3.6655138565511227`*^9}, {3.6655139117702317`*^9, 3.665513925460251*^9}, {
   3.6655139946403475`*^9, 3.665513994770348*^9}, {3.665514099101515*^9, 
   3.665514153461591*^9}, {3.6655142188467035`*^9, 3.665514271331808*^9}, {
   3.665514333724927*^9, 3.6655143607039757`*^9}, 3.665514402751086*^9, {
   3.665514462291191*^9, 3.665514490591231*^9}, {3.6655145367903266`*^9, 
   3.6655145504303455`*^9}, {3.665859630717494*^9, 3.6658597052656193`*^9}, {
   3.6658597398066993`*^9, 3.6658597848917723`*^9}, 3.6658598158208265`*^9, {
   3.665861303657056*^9, 3.66586130628706*^9}, {3.665861432877237*^9, 
   3.6658615197673583`*^9}, {3.665861566207423*^9, 3.665861580647444*^9}, {
   3.6658616603345966`*^9, 3.6658617058646603`*^9}, {3.6658622377104573`*^9, 
   3.6658622645104947`*^9}, {3.6658623517556276`*^9, 3.665862356905635*^9}, {
   3.6658623884056787`*^9, 3.665862392065684*^9}, 3.665862449205764*^9, {
   3.6658625004058356`*^9, 3.6658625434868956`*^9}, 3.6658626181570005`*^9, {
   3.665863394530098*^9, 3.665863429802148*^9}, {3.665934304259*^9, 
   3.6659343106690083`*^9}, {3.6659344775063157`*^9, 
   3.6659344857463274`*^9}, {3.665934525473426*^9, 3.6659345260634265`*^9}, {
   3.66593457801652*^9, 3.6659346132365694`*^9}, 3.6659348503039436`*^9, {
   3.6659349257540493`*^9, 3.6659349319340577`*^9}, {3.6659349675041075`*^9, 
   3.6659349689741096`*^9}, {3.665935121751354*^9, 3.6659351368513756`*^9}, {
   3.6659352118814807`*^9, 3.6659352804015765`*^9}, {3.665935376301711*^9, 
   3.665935391971733*^9}, {3.6659367722104635`*^9, 3.665936850530573*^9}, {
   3.6659368870006237`*^9, 3.6659369215706725`*^9}, {3.665937492552472*^9, 
   3.665937549042551*^9}, {3.6659394311051855`*^9, 3.6659394367951937`*^9}, {
   3.6659395557953606`*^9, 3.6659397030955667`*^9}, {3.665939790786783*^9, 
   3.6659397952267895`*^9}, {3.665939951917009*^9, 3.6659399530970106`*^9}, {
   3.665939986287057*^9, 3.665940004377082*^9}, {3.6659400602181606`*^9, 
   3.665940084878195*^9}, 3.6659401339882636`*^9, {3.6659403142285266`*^9, 
   3.665940357298587*^9}, {3.6659412387038927`*^9, 3.6659412685439343`*^9}, {
   3.6659417331255846`*^9, 3.6659417534756136`*^9}, {3.6659422440613317`*^9, 
   3.6659422476913366`*^9}, {3.6659424415617266`*^9, 
   3.6659424560117464`*^9}, {3.6659426341390376`*^9, 3.665942639389045*^9}, {
   3.665942707939141*^9, 3.6659427141291494`*^9}, {3.665942768569226*^9, 
   3.6659427747792344`*^9}, {3.6659429014684224`*^9, 3.665942923088453*^9}, 
   3.66594310633772*^9, {3.665943245657915*^9, 3.6659432555379286`*^9}, {
   3.665943348185069*^9, 3.6659433762451077`*^9}, 3.665943570314423*^9, {
   3.665943600874466*^9, 3.6659436104944797`*^9}, {3.6659436794955974`*^9, 
   3.665943716143659*^9}, {3.665943757168748*^9, 3.665943768618764*^9}, {
   3.6659438371449013`*^9, 3.665943896403005*^9}, {3.6659444933208513`*^9, 
   3.665944505920869*^9}, {3.66594456401095*^9, 3.665944579050971*^9}, {
   3.6659448513304048`*^9, 3.6659449200695114`*^9}, {3.6659450895318117`*^9, 
   3.6659450961818213`*^9}, {3.665945141481885*^9, 3.6659453111261854`*^9}, {
   3.6659454822354994`*^9, 3.665945540785581*^9}, {3.6659458681350603`*^9, 
   3.665945941755163*^9}, {3.665945990353242*^9, 3.665945999213254*^9}, {
   3.6659460485733232`*^9, 3.6659462559636135`*^9}, {3.6659464480438824`*^9, 
   3.6659464877139378`*^9}, {3.6659467915533686`*^9, 3.665946791953369*^9}, {
   3.6659468811754956`*^9, 3.665946883615499*^9}, 3.665948483637781*^9, 
   3.6660123650690355`*^9, 3.6660130796800365`*^9, {3.6660131821411796`*^9, 
   3.66601318273118*^9}, 3.6660298776105337`*^9, {3.671815110245865*^9, 
   3.671815119137803*^9}, 3.671882061968442*^9, 3.67188234675562*^9, {
   3.671882853303963*^9, 3.6718828536582756`*^9}, 3.671885874513263*^9, {
   3.8782653413248267`*^9, 3.8782653687980394`*^9}, {3.878265406314686*^9, 
   3.8782654076864195`*^9}},ExpressionUUID->"0a2468f1-9d3c-40df-8ccf-\
d895bf20cacf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**"}], "*", "*", 
    RowBox[{"**", "**", "**", "**", "**"}]}], "*****)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**"}], "*", " ", "Saving", " ", "the", " ", "posterior", 
    " ", 
    RowBox[{"distributions", " ", "**", "**", "**"}]}], "*******)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**"}], "*", "*", 
    RowBox[{"**", "**"}]}], "*****)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", "mydirectory", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Save", "[", 
     RowBox[{"\"\<HCM_full_posteriors\>\"", ",", 
      RowBox[{"{", 
       RowBox[{
       "TAphi", ",", "TAtau2lambda", ",", "TAtau2delta", ",", "TAsigma2", ",",
         "TAbeta", ",", "TASIGMA", ",", "m", ",", "g", ",", "l", ",", "d", 
        ",", "n", ",", "f", ",", "ftot", ",", "p", ",", "S", ",", "R", ",", 
        "X", ",", "y", ",", "t0", ",", "ty", ",", "tl", ",", "td", ",", "v0", 
        ",", "v", ",", "lambda0", ",", "Z", ",", "t", ",", "ttaulambda", ",", 
        "ttaudelta", ",", "species"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.541410930421875*^9, 3.54141097075*^9}, {
   3.541411007546875*^9, 3.54141108109375*^9}, {3.541415399421875*^9, 
   3.541415399796875*^9}, {3.541492353171875*^9, 3.541492353546875*^9}, {
   3.541500739609375*^9, 3.541500794328125*^9}, {3.541853830703125*^9, 
   3.541853852140625*^9}, {3.541859461453125*^9, 3.54185946865625*^9}, {
   3.6659462852536545`*^9, 3.6659463508137465`*^9}, 3.666013159651148*^9, {
   3.6660999001961403`*^9, 3.666099940803012*^9}, {3.6718823916423936`*^9, 
   3.671882392043331*^9}, {3.6718824847969575`*^9, 3.671882499505129*^9}, {
   3.6718827541754103`*^9, 3.6718827852695904`*^9}, {3.6718857850817204`*^9, 
   3.6718857863670664`*^9}, 3.6718858970107646`*^9, {3.6719672505296345`*^9, 
   3.6719672506546392`*^9}, {3.671969178114426*^9, 3.671969179036347*^9}, {
   3.8775734207979383`*^9, 3.8775734412975316`*^9}, {3.8775735391692915`*^9, 
   3.8775735451611404`*^9}, {3.878265439044599*^9, 
   3.8782654576794634`*^9}},ExpressionUUID->"da33829b-111f-4450-b71d-\
014d0bcf038a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**"}], "*", "*", 
    RowBox[{"**", "**", "**", "**", "**"}]}], "*****)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**"}], "*", " ", "Examining", " ", "the", " ", "posterior",
     " ", "distributions", " ", 
    RowBox[{"(", 
     RowBox[{"MCMC", " ", "chains"}], ")"}]}], " ", "****)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
      "**", "**", "**", "**", "**", "**", "**", "**"}], "*", "*", 
    RowBox[{"**", "**"}]}], "*****)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", "mydirectory", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "\"\<HCM_full_posteriors\>\""}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.671967285375281*^9, 3.671967296422718*^9}, 
   3.8775735101466947`*^9, {3.8775735588705406`*^9, 3.8775735659117928`*^9}, {
   3.8782654755928164`*^9, 
   3.87826551387179*^9}},ExpressionUUID->"7a3efa1f-c448-4f87-a4b1-\
bbcf23945a9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{" ", "1", ")"}], "spruce"}], ",", " ", "2"}], 
                    ")"}], "pine"}], ",", " ", "3"}], ")"}], "birch"}], ",", 
               " ", "4"}], ")"}], "aspen"}], ",", " ", "5"}], ")"}], "log", 
          " ", "basal", " ", "diameter"}], ",", " ", "6"}], ")"}], "decay", 
       " ", "class"}], ",", " ", "7"}], ")"}], "decay", " ", 
    RowBox[{"class", "^", "2"}]}], " ", "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{" ", "8", ")"}], "year"}], ",", " ", "9"}], ")"}], 
              "calendar", " ", "day"}], ",", " ", "10"}], ")"}], "calendar", 
           " ", 
           RowBox[{"day", "^", "2"}]}], ",", " ", "11"}], ")"}], 
        "precipitation"}], ",", " ", "12"}], ")"}], "RH"}], ","}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{" ", "13", ")"}], "proportion", " ", "of", " ", "night"}], "-", 
    "time"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.67196868683342*^9, 
  3.671968733945222*^9}},ExpressionUUID->"c80bfe10-1c10-458a-ac90-\
5dd727b17968"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"phicovariates", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<spruce\>\"", ",", " ", "\"\<pine\>\"", ",", " ", "\"\<birch\>\"", 
       ",", " ", "\"\<aspen\>\"", ",", " ", "\"\<diam\>\"", ",", 
       "\"\<decay\>\"", ",", "\"\<decay^2\>\"", ",", "\"\<year\>\"", ",", 
       "\"\<day#\>\"", ",", " ", "\"\<day#^2\>\"", ",", "\"\<rain\>\"", ",", 
       "\"\<RH\>\"", ",", "\"\<night\>\""}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"TAphi", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "h", ",", "i"}], "]"}], "]"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<phi \>\"", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "\[LessEqual]", "g"}], ",", 
                RowBox[{"phicovariates", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
              "\"\<\n\>\"", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"species", "[", 
                RowBox[{"[", "h", "]"}], "]"}], "]"}], ",", "\"\<\nn=\>\"", 
              ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"n", "[", 
                RowBox[{"[", "h", "]"}], "]"}], "]"}], ",", "\"\<, l=\>\"", 
              ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"l", "[", 
                RowBox[{"[", "h", "]"}], "]"}], "]"}], ",", "\"\<, d=\>\"", 
              ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"d", "[", 
                RowBox[{"[", "h", "]"}], "]"}], "]"}]}], "]"}]}]}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"f", "[", 
            RowBox[{"[", "h", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"h", ",", "m"}], "}"}]}], "]"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.546068177875*^9, 3.54606818175*^9}, {
   3.54607600990625*^9, 3.546076015234375*^9}, {3.666024827977316*^9, 
   3.666024828663717*^9}, {3.666025015563437*^9, 3.6660250609751167`*^9}, {
   3.6660251210160217`*^9, 3.6660251454612646`*^9}, {3.666025354670829*^9, 
   3.6660253809364743`*^9}, {3.66602544758259*^9, 3.666025456427806*^9}, {
   3.666026484213298*^9, 3.6660264850088997`*^9}, {3.6660265703786488`*^9, 
   3.6660266960176687`*^9}, {3.666026737763342*^9, 3.6660267576533766`*^9}, {
   3.666026842581725*^9, 3.666026842706526*^9}, {3.6660271726859045`*^9, 
   3.66602717571231*^9}, {3.666103945696846*^9, 3.666103975633299*^9}, {
   3.666105785720078*^9, 3.6661057991205015`*^9}, 3.6718151448969073`*^9, 
   3.6719677208117833`*^9, {3.6719677562510877`*^9, 3.6719677691892633`*^9}, {
   3.671969049231636*^9, 3.6719690702483053`*^9}, {3.6719692001936646`*^9, 
   3.6719693100266266`*^9}, {3.671969370598298*^9, 3.671969394552617*^9}, {
   3.6719695668223543`*^9, 3.6719695952831855`*^9}, {3.671969629191161*^9, 
   3.6719696360196123`*^9}, {3.6719697238864107`*^9, 3.6719697338087897`*^9}, 
   3.8782654953582907`*^9},ExpressionUUID->"426aeb47-e082-4808-8a01-\
6695159a7361"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"TAtau2lambda", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "h"}], "]"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<tau2lambda \>\"", ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"species", "[", 
            RowBox[{"[", "h", "]"}], "]"}], "]"}]}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"h", ",", "m"}], "}"}]}], "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.541859827203125*^9, 3.54185982859375*^9}, {
   3.546076062796875*^9, 3.5460760775*^9}, {3.6660270079264154`*^9, 
   3.6660270771905375`*^9}, {3.6660271220326157`*^9, 3.666027159550681*^9}, 
   3.6660273095925446`*^9, {3.6719768487067556`*^9, 
   3.6719769163907375`*^9}},ExpressionUUID->"1ab2e376-1dd9-4455-abb3-\
79bb9aa03a7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"TAtau2delta", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "h"}], "]"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<tau2delta \>\"", ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"species", "[", 
            RowBox[{"[", "h", "]"}], "]"}], "]"}]}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"h", ",", "m"}], "}"}]}], "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.541859827203125*^9, 3.54185982859375*^9}, {
   3.546076062796875*^9, 3.5460760775*^9}, {3.6660270079264154`*^9, 
   3.6660270771905375`*^9}, {3.6660271220326157`*^9, 3.666027159550681*^9}, 
   3.6660273095925446`*^9, {3.6660275400391483`*^9, 3.666027561209386*^9}, {
   3.6719769928372664`*^9, 
   3.671977010494391*^9}},ExpressionUUID->"c09304df-f29e-4fca-bbc1-\
244f03a90132"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"TAsigma2", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "h"}], "]"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<sigma2 \>\"", ",", 
          RowBox[{"ToString", "[", 
           RowBox[{"species", "[", 
            RowBox[{"[", "h", "]"}], "]"}], "]"}]}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"h", ",", "m"}], "}"}]}], "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.541859827203125*^9, 3.54185982859375*^9}, {
   3.546076062796875*^9, 3.5460760775*^9}, {3.6660270079264154`*^9, 
   3.6660270771905375`*^9}, {3.6660271220326157`*^9, 3.666027159550681*^9}, 
   3.6660273095925446`*^9, {3.6660275400391483`*^9, 3.666027561209386*^9}, {
   3.666027958386281*^9, 3.6660279894303355`*^9}, {3.6719770830445623`*^9, 
   3.6719771024830384`*^9}},ExpressionUUID->"487a738a-8675-49a2-8028-\
52a2235a376c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"traitcovariates", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<level\>\"", ",", "\"\<sporevol\>\"", ",", "\"\<res/pil\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"TAbeta", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "k"}], "]"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"traitcovariates", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"Quotient", "[", 
              RowBox[{
               RowBox[{"k", "-", "1"}], ",", "g"}], "]"}], "+", "1"}], "]"}], 
           "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Quotient", "[", 
              RowBox[{
               RowBox[{"k", "-", "1"}], ",", "g"}], "]"}], "\[Equal]", "0"}], 
            ",", "\"\< of \>\"", ",", "\"\< on \>\""}], "]"}], ",", 
          RowBox[{"phicovariates", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"k", "-", "1"}], ",", "g"}], "]"}], "+", "1"}], "]"}], 
           "]"}]}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"g", "*", "p"}]}], "}"}]}], "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.541859827203125*^9, 3.54185982859375*^9}, {
   3.546076062796875*^9, 3.5460760775*^9}, {3.6660270079264154`*^9, 
   3.6660270771905375`*^9}, {3.6660271220326157`*^9, 3.666027159550681*^9}, 
   3.6660273095925446`*^9, {3.6660275400391483`*^9, 3.666027561209386*^9}, {
   3.666027958386281*^9, 3.6660279894303355`*^9}, {3.666028478906993*^9, 
   3.666028532243487*^9}, {3.666028587933584*^9, 3.666028599294404*^9}, {
   3.666106757398985*^9, 3.666106762827794*^9}, {3.67197719449354*^9, 
   3.6719772045297527`*^9}, {3.6719776993086195`*^9, 3.671977713543719*^9}, {
   3.671977767946617*^9, 3.6719778393344183`*^9}, {3.671977882236966*^9, 
   3.671978015280593*^9}, {3.671978107783224*^9, 3.6719781250809755`*^9}, {
   3.671978192730854*^9, 3.6719782443298388`*^9}, 3.6719783065745883`*^9, 
   3.6719784087921658`*^9, {3.671978597348028*^9, 3.6719786177397137`*^9}, {
   3.6719788213222632`*^9, 3.671978821916044*^9}, {3.6719788996277246`*^9, 
   3.671978922019519*^9}, {3.671978968718296*^9, 
   3.671979019335593*^9}},ExpressionUUID->"802375ab-bde2-46d0-bfc5-\
f67343ba9033"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"TASIGMA", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"phicovariates", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "\"\< vs. \>\"", ",", 
          RowBox[{"phicovariates", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "g"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "g"}], "}"}]}], "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5372519293524914`*^9, 3.5372519811297784`*^9}, {
   3.54133326532725*^9, 3.541333289921*^9}, {3.541333335717875*^9, 
   3.54133347020225*^9}, {3.541333500655375*^9, 3.541333550421*^9}, {
   3.541333723124125*^9, 3.541333820921*^9}, {3.541333854405375*^9, 
   3.541333866421*^9}, {3.541333907874125*^9, 3.5413339532335*^9}, {
   3.541333995546*^9, 3.541334027499125*^9}, {3.541334090296*^9, 
   3.5413341403585*^9}, {3.541853865953125*^9, 3.541853960609375*^9}, 
   3.54185951315625*^9, 3.541859833359375*^9, 3.5418599285625*^9, 
   3.541859963828125*^9, 3.54186000421875*^9, {3.541860048953125*^9, 
   3.5418600515*^9}, {3.666028756931079*^9, 3.6660287602538853`*^9}, {
   3.6660287912511396`*^9, 3.6660288310312095`*^9}, {3.671981658636052*^9, 
   3.6719817636818233`*^9}},ExpressionUUID->"49bc5743-2527-49c9-a172-\
38974f920f64"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"**", "**"}], "**"}], "**"}], "**"}], "**"}], 
                    "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
                    "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
             "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
     "**"}], "**"}], "*******)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "**", "**", "**", "**", "**", "**", "**", "**"}], "*", "  ",
     "Calculating", " ", "posterior", " ", "quantile", " ", 
    RowBox[{"values", "  ", "**", "**", "**"}], "*", 
    RowBox[{"**", "**", "**", "**"}]}], "*******)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"**", "**"}], "**"}], "**"}], "**"}], "**"}], 
                    "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
                    "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
             "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], "**"}], 
     "**"}], "**"}], "*******)"}]}]], "Input",
 CellChangeTimes->{{3.541503730078125*^9, 3.5415037799375*^9}, {
  3.66602903971477*^9, 3.6660290451591797`*^9}, {3.878265526922773*^9, 
  3.8782655628021927`*^9}},ExpressionUUID->"88219d61-3ccf-4bdb-adcb-\
5fd238172f1e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"phicovariates", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<spruce\>\"", ",", " ", "\"\<pine\>\"", ",", " ", "\"\<birch\>\"", 
     ",", " ", "\"\<aspen\>\"", ",", " ", "\"\<diam\>\"", ",", 
     "\"\<decay\>\"", ",", "\"\<decay^2\>\"", ",", "\"\<year\>\"", ",", 
     "\"\<day#\>\"", ",", " ", "\"\<day#^2\>\"", ",", "\"\<rain\>\"", ",", 
     "\"\<RH\>\"", ",", "\"\<night\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"traitcovariates", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<level\>\"", ",", "\"\<sporevol\>\"", ",", "\"\<res/pil\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chainstart", "=", "2000"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"start", " ", "discarded", " ", "as", " ", "burn"}], "-", "in"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chainend", "=", "10000"}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiquantheader", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Parameter\>\"", ",", "\"\<Species\>\"", ",", "\"\<Effect\>\"", ",", 
     "\"\<Trunk\>\"", ",", "\"\<Day\>\"", ",", "\"\<Median\>\"", ",", 
     "\"\<post prob >0\>\"", ",", "\"\<post prob <0\>\"", ",", 
     "\"\<0.025 quant\>\"", ",", "\"\<0.975 quant\>\"", ",", 
     "\"\<0.005 quant\>\"", ",", "\"\<0.995 quant\>\"", ",", 
     "\"\<0.0005 quant\>\"", ",", "\"\<0.9995 quant\>\"", ",", "\"\<Min\>\"", 
     ",", "\"\<Max\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiquants", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<phi h=\>\"", ",", 
           RowBox[{"ToString", "[", "h", "]"}], ",", "\"\<, i=\>\"", ",", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
         RowBox[{"species", "[", 
          RowBox[{"[", "h", "]"}], "]"}], ",", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"i", "\[LessEqual]", "g"}], ",", 
           RowBox[{"phicovariates", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"g", "<", "i", "\[LessEqual]", 
            RowBox[{"g", "+", 
             RowBox[{"l", "[", 
              RowBox[{"[", "h", "]"}], "]"}]}]}], ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<trunk \>\"", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"i", "-", "g"}], "]"}]}], "]"}], ",", 
           RowBox[{"i", ">", 
            RowBox[{"g", "+", 
             RowBox[{"l", "[", 
              RowBox[{"[", "h", "]"}], "]"}]}]}], ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<day \>\"", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"i", "-", "g", "-", 
               RowBox[{"l", "[", 
                RowBox[{"[", "h", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}], 
         ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"g", "<", "i", "\[LessEqual]", 
            RowBox[{"g", "+", 
             RowBox[{"l", "[", 
              RowBox[{"[", "h", "]"}], "]"}]}]}], ",", 
           RowBox[{"ToString", "[", 
            RowBox[{"speciestrunkwise", "[", 
             RowBox[{"[", 
              RowBox[{"h", ",", 
               RowBox[{"i", "-", "g"}], ",", "1", ",", "5"}], "]"}], "]"}], 
            "]"}], ",", "\"\<\>\""}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", ">", 
            RowBox[{"g", "+", 
             RowBox[{"l", "[", 
              RowBox[{"[", "h", "]"}], "]"}]}]}], ",", 
           RowBox[{"ToString", "[", 
            RowBox[{"speciesdaywise", "[", 
             RowBox[{"[", 
              RowBox[{"h", ",", 
               RowBox[{"i", "-", "g", "-", 
                RowBox[{"l", "[", 
                 RowBox[{"[", "h", "]"}], "]"}]}], ",", "1", ",", "6"}], 
              "]"}], "]"}], "]"}], ",", "\"\<\>\""}], "]"}], ",", 
         RowBox[{"Quantile", "[", 
          RowBox[{
           RowBox[{"TAphi", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"chainstart", ";;", "chainend"}], ",", "h", ",", "i"}], 
             "]"}], "]"}], ",", "0.5"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"TAphi", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"chainstart", ";;", "chainend"}], ",", "h", ",", 
                "i"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"#", ">", "0"}], "&"}]}], "]"}], "]"}], "/", 
          RowBox[{"N", "[", 
           RowBox[{"(", 
            RowBox[{"chainend", "-", "chainstart", "+", "1"}], ")"}], "]"}]}],
          ",", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"TAphi", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"chainstart", ";;", "chainend"}], ",", "h", ",", 
                "i"}], "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"#", "<", "0"}], "&"}]}], "]"}], "]"}], "/", 
          RowBox[{"N", "[", 
           RowBox[{"(", 
            RowBox[{"chainend", "-", "chainstart", "+", "1"}], ")"}], "]"}]}],
          ",", 
         RowBox[{"Quantile", "[", 
          RowBox[{
           RowBox[{"TAphi", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"chainstart", ";;", "chainend"}], ",", "h", ",", "i"}], 
             "]"}], "]"}], ",", "0.025"}], "]"}], ",", 
         RowBox[{"Quantile", "[", 
          RowBox[{
           RowBox[{"TAphi", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"chainstart", ";;", "chainend"}], ",", "h", ",", "i"}], 
             "]"}], "]"}], ",", "0.975"}], "]"}], ",", 
         RowBox[{"Quantile", "[", 
          RowBox[{
           RowBox[{"TAphi", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"chainstart", ";;", "chainend"}], ",", "h", ",", "i"}], 
             "]"}], "]"}], ",", "0.005"}], "]"}], ",", 
         RowBox[{"Quantile", "[", 
          RowBox[{
           RowBox[{"TAphi", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"chainstart", ";;", "chainend"}], ",", "h", ",", "i"}], 
             "]"}], "]"}], ",", "0.995"}], "]"}], ",", 
         RowBox[{"Quantile", "[", 
          RowBox[{
           RowBox[{"TAphi", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"chainstart", ";;", "chainend"}], ",", "h", ",", "i"}], 
             "]"}], "]"}], ",", "0.0005"}], "]"}], ",", 
         RowBox[{"Quantile", "[", 
          RowBox[{
           RowBox[{"TAphi", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"chainstart", ";;", "chainend"}], ",", "h", ",", "i"}], 
             "]"}], "]"}], ",", "0.9995"}], "]"}], ",", 
         RowBox[{"Min", "[", 
          RowBox[{"TAphi", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"chainstart", ";;", "chainend"}], ",", "h", ",", "i"}], 
            "]"}], "]"}], "]"}], ",", 
         RowBox[{"Max", "[", 
          RowBox[{"TAphi", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"chainstart", ";;", "chainend"}], ",", "h", ",", "i"}], 
            "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"f", "[", 
          RowBox[{"[", "h", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phiquants", "=", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"phiquants", ",", "1"}], "]"}], ",", "phiquantheader"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"betaquantheader", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Parameter\>\"", ",", "\"\<Effect\>\"", ",", "\"\<Median\>\"", ",", 
     "\"\<post prob >0\>\"", ",", "\"\<post prob <0\>\"", ",", 
     "\"\<0.025 quant\>\"", ",", "\"\<0.975 quant\>\"", ",", 
     "\"\<0.005 quant\>\"", ",", "\"\<0.995 quant\>\"", ",", 
     "\"\<0.0005 quant\>\"", ",", "\"\<0.9995 quant\>\"", ",", "\"\<Min\>\"", 
     ",", "\"\<Max\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"betaquants", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<beta \>\"", ",", 
         RowBox[{"ToString", "[", "k", "]"}]}], "]"}], ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"traitcovariates", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"Quotient", "[", 
             RowBox[{
              RowBox[{"k", "-", "1"}], ",", "g"}], "]"}], "+", "1"}], "]"}], 
          "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Quotient", "[", 
             RowBox[{
              RowBox[{"k", "-", "1"}], ",", "g"}], "]"}], "\[Equal]", "0"}], 
           ",", "\"\< of \>\"", ",", "\"\< on \>\""}], "]"}], ",", 
         RowBox[{"phicovariates", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"k", "-", "1"}], ",", "g"}], "]"}], "+", "1"}], "]"}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAbeta", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "k"}], "]"}], 
          "]"}], ",", "0.5"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"TAbeta", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"chainstart", ";;", "chainend"}], ",", "k"}], "]"}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{"#", ">", "0"}], "&"}]}], "]"}], "]"}], "/", 
        RowBox[{"N", "[", 
         RowBox[{"(", 
          RowBox[{"chainend", "-", "chainstart", "+", "1"}], ")"}], "]"}]}], 
       ",", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"TAbeta", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"chainstart", ";;", "chainend"}], ",", "k"}], "]"}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{"#", "<", "0"}], "&"}]}], "]"}], "]"}], "/", 
        RowBox[{"N", "[", 
         RowBox[{"(", 
          RowBox[{"chainend", "-", "chainstart", "+", "1"}], ")"}], "]"}]}], 
       ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAbeta", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "k"}], "]"}], 
          "]"}], ",", "0.025"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAbeta", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "k"}], "]"}], 
          "]"}], ",", "0.975"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAbeta", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "k"}], "]"}], 
          "]"}], ",", "0.005"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAbeta", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "k"}], "]"}], 
          "]"}], ",", "0.995"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAbeta", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "k"}], "]"}], 
          "]"}], ",", "0.0005"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAbeta", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "k"}], "]"}], 
          "]"}], ",", "0.9995"}], "]"}], ",", 
       RowBox[{"Min", "[", 
        RowBox[{"TAbeta", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"chainstart", ";;", "chainend"}], ",", "k"}], "]"}], "]"}],
         "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"TAbeta", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"chainstart", ";;", "chainend"}], ",", "k"}], "]"}], "]"}],
         "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"g", "*", "p"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"betaquants", "=", 
    RowBox[{"Prepend", "[", 
     RowBox[{"betaquants", ",", "betaquantheader"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SIGMAquantheader", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Parameter\>\"", ",", "\"\<Var/cov\>\"", ",", "\"\<Median\>\"", ",", 
     "\"\<post prob >0\>\"", ",", "\"\<post prob <0\>\"", ",", 
     "\"\<0.025 quant\>\"", ",", "\"\<0.975 quant\>\"", ",", 
     "\"\<0.005 quant\>\"", ",", "\"\<0.995 quant\>\"", ",", 
     "\"\<0.0005 quant\>\"", ",", "\"\<0.9995 quant\>\"", ",", "\"\<Min\>\"", 
     ",", "\"\<Max\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SIGMAquants", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<SIGMA \>\"", ",", 
         RowBox[{"ToString", "[", "i", "]"}], ",", "\"\< \>\"", ",", 
         RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"phicovariates", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "\"\< vs. \>\"", ",", 
         RowBox[{"phicovariates", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TASIGMA", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "i", ",", "j"}], 
           "]"}], "]"}], ",", "0.5"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"TASIGMA", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"chainstart", ";;", "chainend"}], ",", "i", ",", "j"}], 
             "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"#", ">", "0"}], "&"}]}], "]"}], "]"}], "/", 
        RowBox[{"N", "[", 
         RowBox[{"(", 
          RowBox[{"chainend", "-", "chainstart", "+", "1"}], ")"}], "]"}]}], 
       ",", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"TASIGMA", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"chainstart", ";;", "chainend"}], ",", "i", ",", "j"}], 
             "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"#", "<", "0"}], "&"}]}], "]"}], "]"}], "/", 
        RowBox[{"N", "[", 
         RowBox[{"(", 
          RowBox[{"chainend", "-", "chainstart", "+", "1"}], ")"}], "]"}]}], 
       ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TASIGMA", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "i", ",", "j"}], 
           "]"}], "]"}], ",", "0.025"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TASIGMA", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "i", ",", "j"}], 
           "]"}], "]"}], ",", "0.975"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TASIGMA", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "i", ",", "j"}], 
           "]"}], "]"}], ",", "0.005"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TASIGMA", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "i", ",", "j"}], 
           "]"}], "]"}], ",", "0.995"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TASIGMA", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "i", ",", "j"}], 
           "]"}], "]"}], ",", "0.0005"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TASIGMA", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "i", ",", "j"}], 
           "]"}], "]"}], ",", "0.9995"}], "]"}], ",", 
       RowBox[{"Min", "[", 
        RowBox[{"TASIGMA", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"chainstart", ";;", "chainend"}], ",", "i", ",", "j"}], 
          "]"}], "]"}], "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"TASIGMA", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"chainstart", ";;", "chainend"}], ",", "i", ",", "j"}], 
          "]"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "g"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "g"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SIGMAquants", "=", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"SIGMAquants", ",", "1"}], "]"}], ",", "SIGMAquantheader"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"tau2lambdaquantheader", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Parameter\>\"", ",", "\"\<Species\>\"", ",", "\"\<Median\>\"", ",", 
     "\"\<0.025 quant\>\"", ",", "\"\<0.975 quant\>\"", ",", 
     "\"\<0.005 quant\>\"", ",", "\"\<0.995 quant\>\"", ",", 
     "\"\<0.0005 quant\>\"", ",", "\"\<0.9995 quant\>\"", ",", "\"\<Min\>\"", 
     ",", "\"\<Max\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tau2lambdaquants", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<tau2lambda \>\"", ",", 
         RowBox[{"ToString", "[", "h", "]"}]}], "]"}], ",", 
       RowBox[{"species", "[", 
        RowBox[{"[", "h", "]"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAtau2lambda", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.5"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAtau2lambda", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.025"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAtau2lambda", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.975"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAtau2lambda", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.005"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAtau2lambda", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.995"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAtau2lambda", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.0005"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAtau2lambda", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.9995"}], "]"}], ",", 
       RowBox[{"Min", "[", 
        RowBox[{"TAtau2lambda", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], "]"}],
         "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"TAtau2lambda", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], "]"}],
         "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tau2lambdaquants", "=", 
    RowBox[{"Prepend", "[", 
     RowBox[{"tau2lambdaquants", ",", "tau2lambdaquantheader"}], "]"}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tau2deltaquantheader", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Parameter\>\"", ",", "\"\<Species\>\"", ",", "\"\<Median\>\"", ",", 
     "\"\<0.025 quant\>\"", ",", "\"\<0.975 quant\>\"", ",", 
     "\"\<0.005 quant\>\"", ",", "\"\<0.995 quant\>\"", ",", 
     "\"\<0.0005 quant\>\"", ",", "\"\<0.9995 quant\>\"", ",", "\"\<Min\>\"", 
     ",", "\"\<Max\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tau2deltaquants", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<tau2delta \>\"", ",", 
         RowBox[{"ToString", "[", "h", "]"}]}], "]"}], ",", 
       RowBox[{"species", "[", 
        RowBox[{"[", "h", "]"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAtau2delta", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.5"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAtau2delta", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.025"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAtau2delta", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.975"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAtau2delta", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.005"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAtau2delta", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.995"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAtau2delta", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.0005"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAtau2delta", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.9995"}], "]"}], ",", 
       RowBox[{"Min", "[", 
        RowBox[{"TAtau2delta", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], "]"}],
         "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"TAtau2delta", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], "]"}],
         "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tau2deltaquants", "=", 
    RowBox[{"Prepend", "[", 
     RowBox[{"tau2deltaquants", ",", "tau2deltaquantheader"}], "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"sigma2quantheader", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Parameter\>\"", ",", "\"\<Species\>\"", ",", "\"\<Median\>\"", ",", 
     "\"\<0.025 quant\>\"", ",", "\"\<0.975 quant\>\"", ",", 
     "\"\<0.005 quant\>\"", ",", "\"\<0.995 quant\>\"", ",", 
     "\"\<0.0005 quant\>\"", ",", "\"\<0.9995 quant\>\"", ",", "\"\<Min\>\"", 
     ",", "\"\<Max\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigma2quants", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<sigma2 \>\"", ",", 
         RowBox[{"ToString", "[", "h", "]"}]}], "]"}], ",", 
       RowBox[{"species", "[", 
        RowBox[{"[", "h", "]"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAsigma2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.5"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAsigma2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.025"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAsigma2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.975"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAsigma2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.005"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAsigma2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.995"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAsigma2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.0005"}], "]"}], ",", 
       RowBox[{"Quantile", "[", 
        RowBox[{
         RowBox[{"TAsigma2", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], 
          "]"}], ",", "0.9995"}], "]"}], ",", 
       RowBox[{"Min", "[", 
        RowBox[{"TAsigma2", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], "]"}],
         "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{"TAsigma2", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"chainstart", ";;", "chainend"}], ",", "h"}], "]"}], "]"}],
         "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"h", ",", "m"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigma2quants", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{"sigma2quants", ",", "sigma2quantheader"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6720552502088594`*^9, 3.672055252544063*^9}, {
  3.6720582293749375`*^9, 3.6720582296439734`*^9}, {3.6720674525585523`*^9, 
  3.6720675049901543`*^9}},ExpressionUUID->"ea6c9841-b16a-4437-992c-\
3a85b07d7b15"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"results", "=", 
   RowBox[{"{", 
    RowBox[{
    "phiquants", ",", "betaquants", ",", "SIGMAquants", ",", 
     "tau2lambdaquants", ",", "tau2deltaquants", ",", "sigma2quants"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "mydirectory", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<HCM_parameter_estimates.xls\>\"", ",", "results", ",", 
    "\"\<xls\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.672060080005954*^9, 3.6720601338881955`*^9}, {
  3.6720602180993195`*^9, 3.672060222890663*^9}, {3.6720653928212233`*^9, 
  3.672065399314843*^9}, {3.672067417692212*^9, 3.6720674185149565`*^9}, {
  3.8782655901228952`*^9, 
  3.8782656175671377`*^9}},ExpressionUUID->"3ed1c056-5143-4d8c-96fd-\
eb8c3c71117b"]
},
WindowSize->{949, 467},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification:>0.75 Inherited,
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b1b9ef5f-d010-47a1-b619-3708e4df8c84"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 609, 12, 36, "Input",ExpressionUUID->"7fd13139-b081-43fd-8fb5-ddb5e63a3a37"],
Cell[CellGroupData[{
Cell[1179, 36, 9602, 243, 454, "Input",ExpressionUUID->"2192cc4b-6793-41bd-8aa2-0faa87cec6a2"],
Cell[10784, 281, 1617, 40, 39, "Output",ExpressionUUID->"82587be5-6cfb-4fa3-bcff-63e488bd5b86"],
Cell[12404, 323, 2129, 56, 68, "Output",ExpressionUUID->"35a7ca25-4a93-482a-aff5-3ae1c9cc0991"],
Cell[14536, 381, 777, 17, 24, "Output",ExpressionUUID->"cabc7d76-af71-4eaf-8178-a500664d243d"],
Cell[15316, 400, 683, 15, 24, "Output",ExpressionUUID->"e7541cc1-a095-4097-a31f-c71f1836b0fe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16036, 420, 13768, 368, 555, "Input",ExpressionUUID->"2ec43869-0971-4ec3-8908-6f980004b230"],
Cell[29807, 790, 2862, 55, 178, "Output",ExpressionUUID->"f594f259-beca-425b-b806-b09eeea7004a"],
Cell[32672, 847, 888, 22, 24, "Output",ExpressionUUID->"71e28a59-b27e-4035-adae-a1c7c19fb9a2"],
Cell[33563, 871, 630, 14, 24, "Output",ExpressionUUID->"0e85562a-5fad-4268-9635-f7fd1248c8e9"],
Cell[34196, 887, 710, 17, 24, "Output",ExpressionUUID->"feb0ecb4-cbba-46fa-9e73-fe6cae7cf7f8"],
Cell[34909, 906, 539, 13, 24, "Output",ExpressionUUID->"4e8c6397-02b7-4628-a7e4-d65601eb04c6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35485, 924, 8142, 229, 252, "Input",ExpressionUUID->"2dc483dc-2e34-4ffc-b29c-4ca50d8727f9"],
Cell[43630, 1155, 6709, 118, 1364, "Output",ExpressionUUID->"c8f125a8-1623-459f-9c0e-097a654910a2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50376, 1278, 1025, 25, 36, "Input",ExpressionUUID->"70721385-b367-408b-93de-6b1d547aca38"],
Cell[51404, 1305, 14990, 410, 103, "Output",ExpressionUUID->"8a953c4a-0e73-4d94-94a2-4ae421846385"]
}, Open  ]],
Cell[66409, 1718, 17847, 456, 684, "Input",ExpressionUUID->"f736ec5f-bcc0-4500-b5d3-24d3a1d8e8cc"],
Cell[84259, 2176, 7949, 212, 352, "Input",ExpressionUUID->"9d41d839-06d7-4a73-bf66-e6a912cef5c2"],
Cell[92211, 2390, 7687, 200, 381, "Input",ExpressionUUID->"74eb1e41-6700-45c3-a2e3-f818184b6013"],
Cell[99901, 2592, 30573, 735, 1216, "Input",ExpressionUUID->"0a2468f1-9d3c-40df-8ccf-d895bf20cacf"],
Cell[130477, 3329, 2557, 52, 137, "Input",ExpressionUUID->"da33829b-111f-4450-b71d-014d0bcf038a"],
Cell[133037, 3383, 1264, 33, 94, "Input",ExpressionUUID->"7a3efa1f-c448-4f87-a4b1-bbcf23945a9d"],
Cell[134304, 3418, 1762, 56, 51, "Input",ExpressionUUID->"c80bfe10-1c10-458a-ac90-5dd727b17968"],
Cell[136069, 3476, 3558, 74, 94, "Input",ExpressionUUID->"426aeb47-e082-4808-8a01-6695159a7361"],
Cell[139630, 3552, 1066, 25, 21, "Input",ExpressionUUID->"1ab2e376-1dd9-4455-abb3-79bb9aa03a7b"],
Cell[140699, 3579, 1114, 26, 21, "Input",ExpressionUUID->"c09304df-f29e-4fca-bbc1-244f03a90132"],
Cell[141816, 3607, 1158, 26, 21, "Input",ExpressionUUID->"487a738a-8675-49a2-8028-52a2235a376c"],
Cell[142977, 3635, 2654, 60, 65, "Input",ExpressionUUID->"802375ab-bde2-46d0-bfc5-f67343ba9033"],
Cell[145634, 3697, 1682, 35, 36, "Input",ExpressionUUID->"49bc5743-2527-49c9-a172-38974f920f64"],
Cell[147319, 3734, 2641, 79, 65, "Input",ExpressionUUID->"88219d61-3ccf-4bdb-adcb-5fd238172f1e"],
Cell[149963, 3815, 27715, 748, 971, "Input",ExpressionUUID->"ea6c9841-b16a-4437-992c-3a85b07d7b15"],
Cell[177681, 4565, 846, 21, 51, "Input",ExpressionUUID->"3ed1c056-5143-4d8c-96fd-eb8c3c71117b"]
}
]
*)

